<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.545">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Adam Kemberling">
<meta name="dcterms.date" content="2022-07-28">
<meta name="description" content="Environmental Conditions at Encounter Locations for Marine Species">

<title>Species Encounter Temperature</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="encounter_temperatures_files/libs/clipboard/clipboard.min.js"></script>
<script src="encounter_temperatures_files/libs/quarto-html/quarto.js"></script>
<script src="encounter_temperatures_files/libs/quarto-html/popper.min.js"></script>
<script src="encounter_temperatures_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="encounter_temperatures_files/libs/quarto-html/anchor.min.js"></script>
<link href="encounter_temperatures_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="encounter_temperatures_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="encounter_temperatures_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="encounter_temperatures_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="encounter_temperatures_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Species Encounter Temperature</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>

<div>
  <div class="description">
    <p>Environmental Conditions at Encounter Locations for Marine Species</p>
  </div>
</div>

<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <a href="https://github.com/adamkemberling">Adam Kemberling</a> 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Gulf of Maine Research Institute
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 28, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="encounter-temperatures-of-size-at-age-species" class="level3">
<h3 class="anchored" data-anchor-id="encounter-temperatures-of-size-at-age-species">Encounter Temperatures of Size-at-Age Species</h3>
<p>Species encountering temperature changes may respond to a changing environment in a number of ways. One approach is that species may choose to change location to a more suitable environment. However; this approach may not be an option for all species. Certain species, and individuals of other species, may lack the mobility/awareness needed to relocate and must survive/persist in the new environment.</p>
<p>This document will look at the different temperatures that species have been caught at. Temperatures will be taken from the CTD casts deployed as part of the groundfish survey to take advantage of bottom temperatures.</p>
<p>The general hypothesis follows that species that are better able to track favorable temperatures should experience a lesser physiological toll than species that are unable to track temperature change. Changes in size-at-age should consequently be smaller in highly mobile species than less adaptable ones.</p>
<div class="cell">

</div>

<style type="text/css">/********** GMRI Rmarkdown Core Style Sheet - Do Not Modify!!! **********/


/********** Begin Style Sheet **********/

/* Avenir Font from Fonts.com for GMRI Branding */

@import url("http://fast.fonts.net/t/1.css?apiType=css&projectid=806f61f6-d695-4965-a878-820b50bc0269");
    @font-face{
        font-family:"Avenir LT W01_35 Light1475496";
        src:url("Fonts/0078f486-8e52-42c0-ad81-3c8d3d43f48e.woff2") format("woff2"),url("Fonts/908c4810-64db-4b46-bb8e-823eb41f68c0.woff") format("woff");
    }
    @font-face{
        font-family:"Avenir LT W01_35 Light_1475502";
        src:url("Fonts/a59168c1-917d-4de9-a244-0316c057c357.woff2") format("woff2"),url("Fonts/6dc0e7d8-9284-44e1-8f05-984a41daa3a4.woff") format("woff");
    }
    @font-face{
        font-family:"Avenir LT W01_45 Book1475508";
        src:url("Fonts/065a6b14-b2cc-446e-9428-271c570df0d9.woff2") format("woff2"),url("Fonts/65d75eb0-2601-4da5-a9a4-9ee67a470a59.woff") format("woff");
    }
    @font-face{
        font-family:"Avenir LT W01_45 Book O1475514";
        src:url("Fonts/476612d9-282d-4f76-95cd-b4dd31e7ed21.woff2") format("woff2"),url("Fonts/f1ebae2b-5296-4244-8771-5f40e60a564a.woff") format("woff");
    }
    @font-face{
        font-family:"Avenir LT W01_55 Roman1475520";
        src:url("Fonts/b290e775-e0f9-4980-914b-a4c32a5e3e36.woff2") format("woff2"),url("Fonts/4b978f72-bb48-46c3-909a-2a8cd2f8819c.woff") format("woff");
    }
    @font-face{
        font-family:"Avenir LT W01_55 Obliqu1475526";
        src:url("Fonts/1a7173fa-062b-49ad-9915-bc57d3bfc1f5.woff2") format("woff2"),url("Fonts/cdda031e-26e9-4269-83d1-5a218caa10db.woff") format("woff");
    }
    @font-face{
        font-family:"Avenir LT W01_65 Medium1475532";
        src:url("Fonts/17b90ef5-b63f-457b-a981-503bb7afe3c0.woff2") format("woff2"),url("Fonts/c9aeeabd-dd65-491d-b4be-3e0db9ae47a0.woff") format("woff");
    }
    @font-face{
        font-family:"Avenir LT W01_65 Medium1475538";
        src:url("Fonts/deb5e718-7abb-4df3-9365-edfa95317090.woff2") format("woff2"),url("Fonts/04801919-17ee-4c6b-8b17-eb1965cb3ed6.woff") format("woff");
    }
    @font-face{
        font-family:"Avenir LT W01_85 Heavy1475544";
        src:url("Fonts/d513e15e-8f35-4129-ad05-481815e52625.woff2") format("woff2"),url("Fonts/61bd362e-7162-46bd-b67e-28f366c4afbe.woff") format("woff");
    }
    @font-face{
        font-family:"Avenir LT W01_85 Heavy_1475550";
        src:url("Fonts/3c210c80-960f-4684-850b-25390b4d08af.woff2") format("woff2"),url("Fonts/cb5c71ad-e582-4d00-929c-67fbfaeb1c27.woff") format("woff");
    }
    @font-face{
        font-family:"Avenir LT W01_95 Black1475556";
        src:url("Fonts/c78eb7af-a1c8-4892-974b-52379646fef4.woff2") format("woff2"),url("Fonts/75b36c58-2a02-4057-a537-09af0832ae46.woff") format("woff");
    }
    @font-face{
        font-family:"Avenir LT W01_95 Black_1475562";
        src:url("Fonts/a2477e08-09d9-4d4b-97a9-23a1e22cb44c.woff2") format("woff2"),url("Fonts/19d12bba-92b1-43ad-9bab-cd36a4195c2a.woff") format("woff");
    }





/* PRE-Avenir Fonts: Lato + Raleway font import from google fonts */
@import url('https://fonts.googleapis.com/css?family=Lato');
@import url('https://fonts.googleapis.com/css?family=Raleway&display=swap');

/* add font families as needed: font-family: 'Lato', sans-serif; */


/* Level 1 Headers */
h1 { text-align: left;
     margin: 10px 0 15px 0; 
     font-size: 38px; 
     font-family: Avenir;
} 


/* Headers 2 - 6 */
h2, h3, h4, h5, h6 { 
    color: #333333; 
    margin: 20px 0 5px 0; 
    text-align: left;
    font-family: Avenir;}


/* Sizing/font For Each Header Type */
h2 { font-size: 24px; }
h3 { font-size: 20px; }
h4 { font-size: 18px; }
h5 { font-size: 16px; font-weight: normal; color: #3069aa; text-decoration: underline;}
h6 { font-size: 14px; font-weight: normal; color: #3069aa; }


/* Paragraph Text */
p, ol { margin-top: 10px; 
    font-family: 'Raleway', sans-serif;}


/* Title Author and Date Headers */
h1.title.toc-ignore {margin-top: 10px;}
h4.author, h4.date {
    color: rgb(0,115,109);
    margin-top: 0px; 
    margin-bottom: 5px; 
    font-size: 12px;}



/* Add Spacing Above Headers */
h1, .h1, h2, .h2, h3, .h3 {
    margin-top: 40px;
}


/* Links */
a {
    color: rgb(234,79,18)
}


/***********************************************/


/********  Table of Contents  **********/

/* Highlighted TOC Element */
.list-group-item.active, .list-group-item.active:focus, .list-group-item.active:hover {
    z-index: 2;
    color: #fff;
    background-color: rgb(0,96,138);
    border-color: rgb(0,96,138);
}

/* Default TOC Elements */
.list-group-item, .list-group-item:focus, .list-group-item:hover {
    z-index: 2;
    color: rgb(0,96,138);
    background-color: #fff;
    border-color: rgb(0,96,138);
}


/********  Tab Panels  **********/

/* Navigation Tabs - Highlighted Tabset Pills */
.nav-pills > li.active > a, .nav-pills > li.active > a:hover, .nav-pills > li.active > a:focus {
    color: #fff;
    background-color: rgb(0,115,109) ;
    }

/* Navigation Tabs - Default Tabset Pills */
.nav-pills > li > a, .nav-pills > li > a:hover, .nav-pills > li > a:focus {
    color: rgb(0,115,109);
    background-color: #fff;
    }


/* Second Level Tabs - Active */
.nav.nav-tabs > li.active  > a, .nav-tabs > li.active > a:hover, .nav-tabs > li.active > a:focus {
    color: #fff;
    background-color: rgb(83,83,83) ;
    }

/* Second Level Tabs - Inactive */
.nav.nav-tabs > li  > a, .nav-tabs > li > a:hover, .nav-tabs > li > a:focus {
    color: rgb(83,83,83);
    background-color: #fff;
    }



/********** End Core Style Sheet **********/
/********** End Core Style Sheet **********/



</style>
</section>
<section id="species-used" class="level3">
<h3 class="anchored" data-anchor-id="species-used">Species Used:</h3>
<p>The species used here will match the 16 species included as part of the size-at-age analysis. Those species are:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Size at age species</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>saa_species <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"acadian redfish"</span>, <span class="st">"american plaice"</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"atlantic cod"</span>, <span class="st">"atlantic herring"</span>, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"atlantic mackerel"</span>, <span class="st">"black sea bass"</span>, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"butterfish"</span>, <span class="st">"haddock"</span>, <span class="st">"pollock"</span>, <span class="st">"red hake"</span>, </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"scup"</span>, <span class="st">"silver hake"</span>, <span class="st">"summer flounder"</span>, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"white hake"</span>, <span class="st">"winter flounder"</span>, </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"witch flounder"</span>, <span class="st">"yellowtail flounder"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># table for printing</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>spec_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"Species"</span> <span class="ot">=</span> saa_species)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>spec_df <span class="sc">%&gt;%</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">acadian redfish</td>
</tr>
<tr class="even">
<td style="text-align: left;">american plaice</td>
</tr>
<tr class="odd">
<td style="text-align: left;">atlantic cod</td>
</tr>
<tr class="even">
<td style="text-align: left;">atlantic herring</td>
</tr>
<tr class="odd">
<td style="text-align: left;">atlantic mackerel</td>
</tr>
<tr class="even">
<td style="text-align: left;">black sea bass</td>
</tr>
<tr class="odd">
<td style="text-align: left;">butterfish</td>
</tr>
<tr class="even">
<td style="text-align: left;">haddock</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pollock</td>
</tr>
<tr class="even">
<td style="text-align: left;">red hake</td>
</tr>
<tr class="odd">
<td style="text-align: left;">scup</td>
</tr>
<tr class="even">
<td style="text-align: left;">silver hake</td>
</tr>
<tr class="odd">
<td style="text-align: left;">summer flounder</td>
</tr>
<tr class="even">
<td style="text-align: left;">white hake</td>
</tr>
<tr class="odd">
<td style="text-align: left;">winter flounder</td>
</tr>
<tr class="even">
<td style="text-align: left;">witch flounder</td>
</tr>
<tr class="odd">
<td style="text-align: left;">yellowtail flounder</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Data for these 17 species comes from fisheries independent trawl survey data collected by NOAA and the NEFSC.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the regional temperatures from {targets}</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>withr<span class="sc">::</span><span class="fu">with_dir</span>(rprojroot<span class="sc">::</span><span class="fu">find_root</span>(<span class="st">'_targets.R'</span>), </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">tar_load</span>(nefsc_stratified))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to just them, and the two time regimes</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>trawldat <span class="ot">&lt;-</span> nefsc_stratified <span class="sc">%&gt;%</span> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(comname <span class="sc">%in%</span> saa_species,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>         est_year <span class="sc">&gt;=</span> <span class="dv">2000</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull the main columns to speed things up</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>trawldat <span class="ot">&lt;-</span> trawldat <span class="sc">%&gt;%</span> </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(cruise6, station, stratum, tow, survey_area,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>         svvessel, source, est_year, est_towdate,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>         season, decdeg_beglat, decdeg_beglon, </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>         avgdepth, bottemp, comname, scientific_name,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>         abundance, biomass_kg, </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>         catchsex, sum_weight_kg)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the regimes</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>trawldat <span class="ot">&lt;-</span> trawldat <span class="sc">%&gt;%</span> </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(est_year, <span class="dv">2000</span>, <span class="dv">2019</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">temp_regime =</span> <span class="fu">ifelse</span>(est_year <span class="sc">&lt;</span> <span class="dv">2010</span>, <span class="st">"Early Regime"</span>, <span class="st">"Warm Regime"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize to total biomass per tow:</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="do">####  WORKING HERE  ####</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. station_totals = biomass and abundance from each tow for all species</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Totals up the abundance and biomass across sex*</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>station_totals <span class="ot">&lt;-</span> trawldat <span class="sc">%&gt;%</span> </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(est_year, survey_area, stratum, tow, est_towdate, avgdepth, bottemp, decdeg_beglat, decdeg_beglon, temp_regime, comname) <span class="sc">%&gt;%</span> </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">biomass_kg =</span> <span class="fu">sum</span>(biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. yrly_avgs = average and sd of biomass </span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>year_avgs <span class="ot">&lt;-</span> station_totals <span class="sc">%&gt;%</span> </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(temp_regime, comname, est_year) <span class="sc">%&gt;%</span> </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_biomass   =</span> <span class="fu">sum</span>(biomass_kg),</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_biomass     =</span> <span class="fu">mean</span>(biomass_kg),</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">biomass_sd      =</span> <span class="fu">sd</span>(biomass_kg),</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_depth       =</span> <span class="fu">weightedMean</span>(avgdepth, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_temp        =</span> <span class="fu">weightedMean</span>(bottemp, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_lat         =</span> <span class="fu">weightedMean</span>(decdeg_beglat, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_lon         =</span> <span class="fu">weightedMean</span>(decdeg_beglon, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">depth_sd        =</span> <span class="fu">weightedSd</span>(avgdepth, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_sd         =</span> <span class="fu">weightedSd</span>(bottemp, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">lat_sd          =</span> <span class="fu">weightedSd</span>(decdeg_beglat, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">lon_sd          =</span> <span class="fu">weightedSd</span>(decdeg_beglon, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Same but the periods as a whole</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>regime_avgs <span class="ot">&lt;-</span> station_totals  <span class="sc">%&gt;%</span> </span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(temp_regime, comname) <span class="sc">%&gt;%</span> </span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_biomass   =</span> <span class="fu">sum</span>(biomass_kg),</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_biomass     =</span> <span class="fu">mean</span>(biomass_kg),</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">biomass_sd      =</span> <span class="fu">sd</span>(biomass_kg),</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_depth       =</span> <span class="fu">weightedMean</span>(avgdepth, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_temp        =</span> <span class="fu">weightedMean</span>(bottemp, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_lat         =</span> <span class="fu">weightedMean</span>(decdeg_beglat, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_lon         =</span> <span class="fu">weightedMean</span>(decdeg_beglon, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">depth_sd        =</span> <span class="fu">weightedSd</span>(avgdepth, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_sd         =</span> <span class="fu">weightedSd</span>(bottemp, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">lat_sd          =</span> <span class="fu">weightedSd</span>(decdeg_beglat, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">lon_sd          =</span> <span class="fu">weightedSd</span>(decdeg_beglon, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a><span class="do">####  ROAD BLOCK  ####</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the reference point to standardize against?</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a><span class="co"># option 1: what is the variance in station measurements</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a><span class="co"># option 2: weight that by the biomass there? no, right?</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a><span class="co"># variance within a period, or overall</span></span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Variance specific for each species, ya?</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Variance across all years within each species</span></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>global_benchmarks <span class="ot">&lt;-</span> station_totals <span class="sc">%&gt;%</span> </span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(comname) <span class="sc">%&gt;%</span> </span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_biomass     =</span> <span class="fu">mean</span>(biomass_kg),</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">biomass_sd      =</span> <span class="fu">sd</span>(biomass_kg),</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_depth       =</span> <span class="fu">weightedMean</span>(avgdepth, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_temp        =</span> <span class="fu">weightedMean</span>(bottemp, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_lat         =</span> <span class="fu">weightedMean</span>(decdeg_beglat, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_lon         =</span> <span class="fu">weightedMean</span>(decdeg_beglon, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">depth_sd        =</span> <span class="fu">weightedSd</span>(avgdepth, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_sd         =</span> <span class="fu">weightedSd</span>(bottemp, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">lat_sd          =</span> <span class="fu">weightedSd</span>(decdeg_beglat, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">lon_sd          =</span> <span class="fu">weightedSd</span>(decdeg_beglon, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">####  Old code</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize the biomass by what the total catch was that period</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># These are then used as weights for mean/median estimates</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Un-Stratified abundance</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Un-Stratified length-weight biomass</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Un-stratified, all-size Biomass</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># trawldat &lt;- trawldat %&gt;%</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(comname, temp_regime) %&gt;%</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">#     group_abund = sum(numlen_adj, na.rm = T),</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">#     group_bio   = sum(biom_per_lclass,  na.rm = T)) %&gt;%</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co">#   ungroup() %&gt;%</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co">#     abund_wt    = numlen_adj / group_abund,</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co">#     biom_wt     = biom_per_lclass / group_bio,</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co">#     temp_regime = factor(temp_regime, levels = c("Early Regime", "Warm Regime")))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="bottom-temperatures" class="level2">
<h2 class="anchored" data-anchor-id="bottom-temperatures">Bottom Temperatures</h2>
<p>Using the bottom temperatures sampled before each tow, and the biomass caught at each tow, the following weighted distributions can be generated for what the conditions were at each location these species were caught.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># What were temps doing over the whole region:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>oisst_all <span class="ot">&lt;-</span> <span class="fu">oisst_access_timeseries</span>(<span class="st">"nmfs_trawl_regions"</span>, <span class="at">poly_name =</span> <span class="st">"inuse strata"</span>, <span class="at">mac_os =</span> <span class="st">"mojave"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Yearly averages</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>oisst_yrs <span class="ot">&lt;-</span> oisst_all <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">as.Date</span>(time)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(time)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp =</span> <span class="fu">mean</span>(area_wtd_sst),</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">clim =</span> <span class="fu">mean</span>(area_wtd_clim),</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">anom =</span> <span class="fu">mean</span>(area_wtd_anom)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(year, <span class="dv">2000</span>, <span class="dv">2019</span>))</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(oisst_yrs, <span class="fu">aes</span>(year, anom)) <span class="sc">+</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="fu">gmri_cols</span>(<span class="st">"gmri blue"</span>)) <span class="sc">+</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Survey Area Temperature Anomalies"</span>,</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Temperature Anomaly Â°C"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="encounter_temperatures_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Yearly Movements</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Regime Averages</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Relative Shifts</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Yearly averages</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Join and Scale by Global Averages</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>temp_yrly <span class="ot">&lt;-</span> <span class="fu">weighted_df_fun</span>(bottemp, est_year, temp_regime) <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(global_benchmarks, <span class="fu">c</span>(<span class="st">"comname"</span>, <span class="st">"avg_temp"</span>, <span class="st">"temp_sd"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">biom_z =</span> (biom_mu <span class="sc">-</span> avg_temp) <span class="sc">/</span> temp_sd) </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Each timeline</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>temp_yrly <span class="sc">%&gt;%</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(est_year, biom_z, <span class="at">color =</span> temp_regime)) <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"Overall Average"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">group =</span> comname), <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gmri</span>() <span class="sc">+</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Shift in Bottom Temperatures of Catch Locations"</span>,</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Yearly averages weighted by biomass, scaled against all-year average."</span>,</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Bottom Temperature (z)"</span>,  </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Time Period"</span>, </span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Time Period"</span>) <span class="sc">+</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="co">#axis.text.y = element_blank(),</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="encounter_temperatures_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run weighting function for bottom temp</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>temp_change <span class="ot">&lt;-</span> <span class="fu">weighted_df_fun</span>(bottemp, temp_regime) <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(global_benchmarks, <span class="fu">c</span>(<span class="st">"comname"</span>, <span class="st">"avg_temp"</span>, <span class="st">"temp_sd"</span>)), <span class="at">by =</span> <span class="st">"comname"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">biom_z =</span> (biom_mu <span class="sc">-</span> avg_temp) <span class="sc">/</span> temp_sd) </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Get results on significance</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>temp_results <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">.x =</span> saa_species, </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">.f =</span> test_signif, </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">dependent_var =</span> <span class="st">"bottemp"</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Get regime averages</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>temp_avgs <span class="ot">&lt;-</span> temp_change <span class="sc">%&gt;%</span> </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(temp_regime) <span class="sc">%&gt;%</span> </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">biom_avg =</span> <span class="fu">round</span>(<span class="fu">mean</span>(biom_mu),<span class="dv">2</span>),</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">biom_med =</span> <span class="fu">round</span>(<span class="fu">mean</span>(biom_median), <span class="dv">2</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1. Weighted by Stratified Biomass</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co"># And another df for connecting the points</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>mu_segment_df <span class="ot">&lt;-</span> temp_change <span class="sc">%&gt;%</span> </span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(comname, temp_regime, biom_mu) <span class="sc">%&gt;%</span> </span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"temp_regime"</span>, </span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="fu">c</span>(biom_mu)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Track the Change in mean Locations</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">avg_shift =</span> <span class="st">`</span><span class="at">Warm Regime</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>,</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Reorder the species factors by mean temperature preference</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">comname =</span> <span class="fu">fct_reorder</span>(comname, <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>, <span class="at">.fun =</span> median))</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder factor by warm-tolerance in Early regime</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>temp_change <span class="ot">&lt;-</span> temp_change <span class="sc">%&gt;%</span> </span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comname =</span> <span class="fu">factor</span>(comname, <span class="at">levels =</span> <span class="fu">levels</span>(mu_segment_df<span class="sc">$</span>comname)))</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Density Plots for Each species</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">geom_link</span>(<span class="at">data =</span> mu_segment_df,</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>,</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> <span class="st">`</span><span class="at">Warm Regime</span><span class="st">`</span>,</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> <span class="dv">0</span>,</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>                   <span class="at">group =</span> comname,</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fu">stat</span>(index),</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"Warm Regime"</span>),</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.75</span>,</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> temp_change ,</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> biom_mu, </span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> <span class="dv">0</span>, </span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> temp_regime),</span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>             <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(comname<span class="sc">~</span>.) <span class="sc">+</span></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gmri</span>() <span class="sc">+</span></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gmri</span>() <span class="sc">+</span></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Shift in Bottom Temperatures of Catch Locations"</span>,</span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Biomass-weighted averages shown as points."</span>,</span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">""</span>,  </span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Bottom Temperature \u00b0C"</span>, </span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Time Period"</span>, </span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Time Period"</span>) <span class="sc">+</span></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="encounter_temperatures_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>For the following figure, the average of each temperature regime was scaled against the weighed average and standard deviation across all years.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># And another df for connecting the points</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>z_segment_df <span class="ot">&lt;-</span> temp_change <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(comname, temp_regime, biom_z) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"temp_regime"</span>, </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="fu">c</span>(biom_z)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Track the Change in mean Locations</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">avg_shift =</span> <span class="st">`</span><span class="at">Warm Regime</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Reorder the species factors to match the previous plots</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">comname =</span> <span class="fu">factor</span>(comname, <span class="at">levels =</span> <span class="fu">levels</span>(temp_change<span class="sc">$</span>comname)))</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Density Plots for Each species</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">geom_link</span>(<span class="at">data =</span> z_segment_df,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> <span class="st">`</span><span class="at">Warm Regime</span><span class="st">`</span>,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> <span class="dv">0</span>,</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>                   <span class="at">group =</span> comname,</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fu">stat</span>(index),</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"Warm Regime"</span>),</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.75</span>,</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> temp_change ,</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> biom_z, </span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> <span class="dv">0</span>, </span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> temp_regime),</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>             <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(comname<span class="sc">~</span>.) <span class="sc">+</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gmri</span>() <span class="sc">+</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gmri</span>() <span class="sc">+</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">by =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Shift in Relative Bottom Temperatures"</span>,</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Standardized biomass-weighted averages shown as points."</span>,</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">""</span>,  </span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Bottom Temperature (z)"</span>, </span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Time Period"</span>, </span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Time Period"</span>) <span class="sc">+</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="encounter_temperatures_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<section id="temperature-summary" class="level3">
<h3 class="anchored" data-anchor-id="temperature-summary">Temperature Summary</h3>
<p>Across all species the average temperature (by biomass) has increased from 8.59 to 9.09 for a change in 0.5Â°C.</p>
<p>14 of the 17 showed a significant change in temperature among the different regimes indicating a change in habitat conditions regardless of avoidance strategy.</p>
<p>In the following figure the biomass densities for the early and warm temperature regimes are shown for each species. The distributions are weighted by biomass of catch at each location. The weighed means are also shown for each regime.</p>
</section>
</section>
<section id="center-of-latitude" class="level2">
<h2 class="anchored" data-anchor-id="center-of-latitude">Center of Latitude</h2>
<p>The (weighted) centers of latitude give an indication of whether a species is shifting its location Northward or Southward.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Yearly Movements</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Regime Averages</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Relative Shifts</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weighted mean Locations</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>lat_yrly <span class="ot">&lt;-</span> <span class="fu">weighted_df_fun</span>(decdeg_beglat, est_year, temp_regime) <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(global_benchmarks, <span class="fu">c</span>(<span class="st">"comname"</span>, <span class="st">"avg_lat"</span>, <span class="st">"lat_sd"</span>)), <span class="at">by =</span> <span class="st">"comname"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">biom_z =</span> (biom_mu <span class="sc">-</span> avg_lat) <span class="sc">/</span> lat_sd) </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Each timeline</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>lat_yrly <span class="sc">%&gt;%</span> </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(est_year, biom_z, <span class="at">color =</span> temp_regime)) <span class="sc">+</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"Overall Average"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">group =</span> comname), <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gmri</span>() <span class="sc">+</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Shift in Latitude of Catch Locations"</span>,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Yearly averages weighted by biomass, scaled against all-year average."</span>,</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Center of Biomass Latitude (z)"</span>,  </span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Time Period"</span>, </span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Time Period"</span>) <span class="sc">+</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="co">#axis.text.y = element_blank(),</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="encounter_temperatures_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weighted mean Locations</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>lat_change <span class="ot">&lt;-</span> <span class="fu">weighted_df_fun</span>(decdeg_beglat, temp_regime) <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(global_benchmarks, <span class="fu">c</span>(<span class="st">"comname"</span>, <span class="st">"avg_lat"</span>, <span class="st">"lat_sd"</span>)), <span class="at">by =</span> <span class="st">"comname"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">biom_z =</span> (biom_mu <span class="sc">-</span> avg_lat) <span class="sc">/</span> lat_sd) </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Get regime averages</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>lat_avgs <span class="ot">&lt;-</span> lat_change <span class="sc">%&gt;%</span> </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(temp_regime) <span class="sc">%&gt;%</span> </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">biom_avg =</span> <span class="fu">round</span>(<span class="fu">mean</span>(biom_mu),<span class="dv">2</span>),</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">biom_med =</span> <span class="fu">round</span>(<span class="fu">mean</span>(biom_median), <span class="dv">2</span>))</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1. Weighted by Stratified Biomass</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co"># And another df for connecting the points</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>lat_segment_df <span class="ot">&lt;-</span> lat_change <span class="sc">%&gt;%</span> </span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(comname, temp_regime, biom_mu) <span class="sc">%&gt;%</span> </span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"temp_regime"</span>, </span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="fu">c</span>(biom_mu)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">avg_shift =</span> <span class="st">`</span><span class="at">Warm Regime</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder the species factors by mean temperature preference</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>lat_segment_df <span class="ot">&lt;-</span> lat_segment_df <span class="sc">%&gt;%</span> </span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comname =</span> <span class="fu">fct_reorder</span>(comname, <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>, <span class="at">.fun =</span> median, <span class="at">.desc =</span> T))</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder factor by warm-tolerance in Early regime</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>lat_change <span class="ot">&lt;-</span> lat_change <span class="sc">%&gt;%</span> </span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comname =</span> <span class="fu">factor</span>(comname, <span class="at">levels =</span> <span class="fu">levels</span>(lat_segment_df<span class="sc">$</span>comname)))</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a Plot of Major cities/landmarks for reference</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>lat_references <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cities"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"NY, NY"</span>, <span class="st">"Chatham, MA"</span>, <span class="st">"Cape May, NJ"</span>),</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>  <span class="st">"lat"</span> <span class="ot">=</span> <span class="fu">c</span>( <span class="fl">40.72</span>,  <span class="fl">41.68</span>, <span class="fl">38.93</span>) )</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Latitude Change with City References</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()  <span class="sc">+</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_link</span>(<span class="at">data =</span> lat_segment_df,</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">y =</span> <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>,</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> <span class="st">`</span><span class="at">Warm Regime</span><span class="st">`</span>,</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> comname,</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> comname,<span class="at">group =</span> comname,</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fu">stat</span>(index),</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"Warm Regime"</span>),</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.75</span>,</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> lat_change ,</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> comname, </span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> biom_mu, </span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> temp_regime),</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>             <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_hline(data = lat_references, aes(yintercept = lat), color = "gray60") +</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> lat_references, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">3.5</span>, <span class="at">label =</span> cities, <span class="at">y =</span> lat)) <span class="sc">+</span></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gmri</span>() <span class="sc">+</span></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gmri</span>() <span class="sc">+</span></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">30</span>, <span class="dv">60</span>, <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Shift in Center of Biomass Latitudes"</span>,</span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Distributions weighted by biomass, weighted means shown as points."</span>,</span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Center of Biomass Latitude \u00b0N"</span>,  </span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Time Period"</span>, </span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Time Period"</span>) <span class="sc">+</span></span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="encounter_temperatures_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Species showing the largest latitudinal shifts include Atlantic mackerel, scup, and Black Sea Bass. These species all have center of biomass latitudes South of Cape Cod, and have some of the largest potential for Northward movements within the survey area.</p>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>For the following figure, the average of each temperature regime was scaled against the weighed average and standard deviation across all years.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># And another df for connecting the points</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>z_segment_df <span class="ot">&lt;-</span> lat_change <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(comname, temp_regime, biom_z) <span class="sc">%&gt;%</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"temp_regime"</span>, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="fu">c</span>(biom_z)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Track the Change in mean Locations</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">avg_shift =</span> <span class="st">`</span><span class="at">Warm Regime</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Reorder the species factors to match the previous plots</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">comname =</span> <span class="fu">factor</span>(comname, <span class="at">levels =</span> <span class="fu">levels</span>(lat_change<span class="sc">$</span>comname)))</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Density Plots for Each species</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()  <span class="sc">+</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_link</span>(<span class="at">data =</span> z_segment_df,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">y =</span> <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> <span class="st">`</span><span class="at">Warm Regime</span><span class="st">`</span>,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> comname,</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> comname,<span class="at">group =</span> comname,</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fu">stat</span>(index),</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"Warm Regime"</span>),</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.75</span>,</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> lat_change ,</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> comname, </span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> biom_z, </span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> temp_regime),</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>             <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gmri</span>() <span class="sc">+</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gmri</span>() <span class="sc">+</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">by =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Shift in Standardized Center of Biomass Latitudes"</span>,</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Distributions weighted by biomass, weighted means shown as points."</span>,</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Center of Biomass Latitude (z)"</span>,  </span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Time Period"</span>, </span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Time Period"</span>) <span class="sc">+</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="encounter_temperatures_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<section id="latitude-summary" class="level3">
<h3 class="anchored" data-anchor-id="latitude-summary">Latitude Summary</h3>
<p>Across all species the average Latitude at capture has increased from 41.39 to 41.61 for a change in 0.22 Â° Latitude.</p>
</section>
</section>
<section id="capture-depth" class="level2">
<h2 class="anchored" data-anchor-id="capture-depth">Capture Depth</h2>
<p>Depth is highly correlated with temperature and may be an avenue for species to follow their thermal preferences without moving Northward. If species are moving deeper without changing their temperature habitats this may suggest a different driver is at play.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Yearly Movements</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Regime Averages</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Relative Shifts</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weighted mean Locations</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>depth_yrly <span class="ot">&lt;-</span> <span class="fu">weighted_df_fun</span>(avgdepth, est_year, temp_regime) <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(global_benchmarks, <span class="fu">c</span>(<span class="st">"comname"</span>, <span class="st">"avg_depth"</span>, <span class="st">"depth_sd"</span>)), <span class="at">by =</span> <span class="st">"comname"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">biom_z =</span> (biom_mu <span class="sc">-</span> avg_depth) <span class="sc">/</span> depth_sd) </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Each timeline</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>depth_yrly <span class="sc">%&gt;%</span> </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(est_year, biom_z, <span class="at">color =</span> temp_regime)) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"Overall Average"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">group =</span> comname), <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gmri</span>() <span class="sc">+</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Shift in Depth of Catch Locations"</span>,</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Yearly averages weighted by biomass, scaled against all-year average."</span>,</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Center of Biomass Depth (z)"</span>,  </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Time Period"</span>, </span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Time Period"</span>) <span class="sc">+</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="co">#axis.text.y = element_blank(),</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="encounter_temperatures_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weighted mean Locations</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>depth_change <span class="ot">&lt;-</span> <span class="fu">weighted_df_fun</span>(avgdepth, temp_regime) <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(global_benchmarks, <span class="fu">c</span>(<span class="st">"comname"</span>, <span class="st">"avg_depth"</span>, <span class="st">"depth_sd"</span>)), <span class="at">by =</span> <span class="st">"comname"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">biom_z =</span> (biom_mu <span class="sc">-</span> avg_depth) <span class="sc">/</span> depth_sd) </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Avg Depths </span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>avg_depths <span class="ot">&lt;-</span> depth_change <span class="sc">%&gt;%</span> </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(temp_regime) <span class="sc">%&gt;%</span> </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">biom_avg =</span> <span class="fu">round</span>(<span class="fu">mean</span>(biom_mu),<span class="dv">2</span>),</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">biom_med =</span> <span class="fu">round</span>(<span class="fu">mean</span>(biom_median), <span class="dv">2</span>))</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1. Weighted by Stratified Biomass</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co"># And another df for connecting the points</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>depth_segment_df <span class="ot">&lt;-</span> depth_change <span class="sc">%&gt;%</span> </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(comname, temp_regime, biom_mu) <span class="sc">%&gt;%</span> </span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"temp_regime"</span>, </span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="fu">c</span>(biom_mu)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">avg_shift =</span> <span class="st">`</span><span class="at">Warm Regime</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder the species factors by mean temperature preference</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>depth_segment_df <span class="ot">&lt;-</span> depth_segment_df <span class="sc">%&gt;%</span> </span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comname =</span> <span class="fu">fct_reorder</span>(comname, <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>, <span class="at">.fun =</span> median, <span class="at">.desc =</span> F))</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder factor by warm-tolerance in Early regime</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>depth_change <span class="ot">&lt;-</span> depth_change <span class="sc">%&gt;%</span> </span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comname =</span> <span class="fu">factor</span>(comname, <span class="at">levels =</span> <span class="fu">levels</span>(depth_segment_df<span class="sc">$</span>comname)))</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Density Plots for Each species</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">geom_link</span>(<span class="at">data =</span> depth_segment_df,</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">y =</span> <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>,</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> <span class="st">`</span><span class="at">Warm Regime</span><span class="st">`</span>,</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> comname,</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> comname,</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>                   <span class="at">alpha =</span> <span class="fu">stat</span>(index),</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"Warm Regime"</span>),</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.75</span>,</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> depth_change ,</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> biom_mu, </span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x =</span> comname, </span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> temp_regime),</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>             <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gmri</span>() <span class="sc">+</span></span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gmri</span>() <span class="sc">+</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">300</span>, <span class="at">by =</span> <span class="dv">50</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">200</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Shift in Depth of Catch Locations"</span>,</span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Distributions weighted by stratified biomass, weighted means shown as points."</span>,</span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,  </span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Depth (m)"</span>, </span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Time Period"</span>, </span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Time Period"</span>) <span class="sc">+</span></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="encounter_temperatures_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># And another df for connecting the points</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>z_segment_df <span class="ot">&lt;-</span> depth_change <span class="sc">%&gt;%</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(comname, temp_regime, biom_z) <span class="sc">%&gt;%</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"temp_regime"</span>, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="fu">c</span>(biom_z)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Track the Change in mean Locations</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">avg_shift =</span> <span class="st">`</span><span class="at">Warm Regime</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Reorder the species factors to match the previous plots</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">comname =</span> <span class="fu">factor</span>(comname, <span class="at">levels =</span> <span class="fu">levels</span>(depth_change<span class="sc">$</span>comname)))</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Density Plots for Each species</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()  <span class="sc">+</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_link</span>(<span class="at">data =</span> z_segment_df,</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">y =</span> <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>,</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> <span class="st">`</span><span class="at">Warm Regime</span><span class="st">`</span>,</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> comname,</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> comname,<span class="at">group =</span> comname,</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fu">stat</span>(index),</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"Warm Regime"</span>),</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.75</span>,</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> depth_change ,</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> comname, </span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> biom_z, </span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> temp_regime),</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>             <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gmri</span>() <span class="sc">+</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gmri</span>() <span class="sc">+</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">by =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Shift in Standardized Center of Biomass Depth"</span>,</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Distributions weighted by biomass, weighted means shown as points."</span>,</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Center of Biomass Depth (z)"</span>,  </span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Time Period"</span>, </span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Time Period"</span>) <span class="sc">+</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="encounter_temperatures_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>Across all species the average depth (by biomass) has increased from 117.35 to 124.12 for a change in 6.77 meters.</p>
</section>
<section id="center-of-biomass" class="level2">
<h2 class="anchored" data-anchor-id="center-of-biomass">Center of Biomass</h2>
<p>Using both Lat/Lon we can determine a center of biomass, and how that has changed between regimes for each species.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weighted mean Locations</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>center_coord_df <span class="ot">&lt;-</span> station_totals <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(comname, temp_regime) <span class="sc">%&gt;%</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">biom_lat  =</span> <span class="fu">weightedMean</span>(decdeg_beglat, biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">biom_lon  =</span> <span class="fu">weightedMean</span>(decdeg_beglon, biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span>) </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Coord ranges to crop</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>xlim <span class="ot">&lt;-</span> <span class="fu">range</span>(center_coord_df<span class="sc">$</span>biom_lon)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>ylim <span class="ot">&lt;-</span> <span class="fu">range</span>(center_coord_df<span class="sc">$</span>biom_lat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">COB Shifts</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the map</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> us_poly) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> canada) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">geom_link2</span>(</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> center_coord_df,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> biom_lon, </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> biom_lat, </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">group =</span> comname,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fu">stat</span>(index),</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"Warm Regime"</span>),</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.75</span>,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> center_coord_df, <span class="fu">aes</span>(<span class="at">x =</span> biom_lon, <span class="at">y =</span> biom_lat, <span class="at">color =</span> temp_regime), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">data =</span> <span class="fu">filter</span>(center_coord_df, temp_regime <span class="sc">==</span> <span class="st">"Warm Regime"</span>), </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> comname, <span class="at">x =</span> biom_lon, <span class="at">y =</span> biom_lat), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gmri</span>() <span class="sc">+</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim =</span> xlim, <span class="at">ylim =</span> ylim) <span class="sc">+</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Temperature Regime"</span>, <span class="at">title =</span> <span class="st">"Weighted-Mean Center of Biomass"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="encounter_temperatures_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="move-vs.-acclimate" class="level2">
<h2 class="anchored" data-anchor-id="move-vs.-acclimate">Move vs.&nbsp;Acclimate</h2>
<p>Species can achieve similar outcomes through either moving deeper, or more Northward, or some combination of both.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Put metrics of species movements into one list/table:</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>change_datasets <span class="ot">&lt;-</span> <span class="fu">list</span>(lat_change, depth_change, temp_change)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Pick mean/median and whether we want biomass or Biomass weighting:</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>change_datasets <span class="ot">&lt;-</span> <span class="fu">map</span>(change_datasets, <span class="cf">function</span>(x){</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Grab the variable</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  var_name <span class="ot">&lt;-</span> <span class="fu">distinct</span>(x, var) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  z_name <span class="ot">&lt;-</span> <span class="fu">str_c</span>(var_name, <span class="st">"_z"</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Grab just those columns to compare across regimes:</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pivot wider, and find difference</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Change in Standardized Means</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  mu_dat <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">select</span>(comname, temp_regime, biom_z) <span class="sc">%&gt;%</span> </span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> biom_z, <span class="at">names_from =</span> temp_regime) <span class="sc">%&gt;%</span> </span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">mu_change =</span> <span class="st">`</span><span class="at">Warm Regime</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">"Early Regime"</span>, <span class="st">"Warm Regime"</span>))</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">setNames</span>(mu_dat, <span class="fu">c</span>(<span class="st">"comname"</span>, z_name)))</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rejoin</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#left_join(med_dat, mu_dat) %&gt;% setNames(c("comname", med_name, mu_name))</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Join them</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>change_df <span class="ot">&lt;-</span> <span class="fu">left_join</span>(change_datasets[[<span class="dv">1</span>]], change_datasets[[<span class="dv">2</span>]]) <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(change_datasets[[<span class="dv">3</span>]])</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare those features to the change in growth</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Depth and Latitude</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Temperature and Latitude</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Temperature and Depth</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(change_df, <span class="fu">aes</span>(avgdepth_z, decdeg_beglat_z)) <span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y<span class="sc">~</span>x, <span class="at">color =</span> <span class="fu">gmri_cols</span>(<span class="st">"gmri blue"</span>)) <span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Delta<span class="sc">~</span><span class="st">"Depth (z)"</span>),</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(Delta<span class="sc">~</span><span class="st">"Lat"</span><span class="sc">~</span>degree<span class="sc">~</span>N<span class="sc">~</span><span class="er">~</span><span class="st">"(z)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="encounter_temperatures_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(change_df, <span class="fu">aes</span>(bottemp_z, decdeg_beglat_z)) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y<span class="sc">~</span>x, <span class="at">color =</span> <span class="fu">gmri_cols</span>(<span class="st">"gmri blue"</span>)) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Delta<span class="sc">~</span><span class="st">"Bottom Temperature (z)"</span>),</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(Delta<span class="sc">~</span><span class="st">"Lat"</span><span class="sc">~</span>degree<span class="sc">~</span>N<span class="sc">~</span><span class="er">~</span><span class="st">"(z)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="encounter_temperatures_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(change_df, <span class="fu">aes</span>(bottemp_z, avgdepth_z)) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y<span class="sc">~</span>x, <span class="at">color =</span> <span class="fu">gmri_cols</span>(<span class="st">"gmri blue"</span>)) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Delta<span class="sc">~</span><span class="st">"Bottom Temperature (z)"</span>),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(Delta<span class="sc">~</span><span class="st">"Depth (z)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="encounter_temperatures_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "î§";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb21" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Species Encounter Temperature"</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> </span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">    name: "Adam Kemberling"</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co">    url: https://github.com/adamkemberling</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliation: Gulf of Maine Research Institute</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> | </span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">  Environmental Conditions at Encounter Locations for Marine Species</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "Updated on: `r Sys.Date()`"</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: kable</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="co">  fig.height: 10</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="co">  fig.width: 6</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="co">  fig.align: "center"</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a><span class="co">  comment: ""</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="fu">### Encounter Temperatures of Size-at-Age Species</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>Species encountering temperature changes may respond to a changing environment in a number of ways. One approach is that species may choose to change location to a more suitable environment. However; this approach may not be an option for all species. Certain species, and individuals of other species, may lack the mobility/awareness needed to relocate and must survive/persist in the new environment.</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>This document will look at the different temperatures that species have been caught at. Temperatures will be taken from the CTD casts deployed as part of the groundfish survey to take advantage of bottom temperatures.</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>The general hypothesis follows that species that are better able to track favorable temperatures should experience a lesser physiological toll than species that are unable to track temperature change. Changes in size-at-age should consequently be smaller in highly mobile species than less adaptable ones.</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a><span class="in">```{r survdat data}</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo = FALSE</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a><span class="do">####  Packages  ####</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gmRi)</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnaturalearth)</span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(targets)</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xaringanExtra)</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist)</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geomtextpath)</span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(colorspace)</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(matrixStats)</span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Set theme</span></span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_gmri</span>())</span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Map polygons</span></span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a>us_poly <span class="ot">&lt;-</span> <span class="fu">ne_states</span>(<span class="st">"united states of america"</span>, <span class="at">returnclass =</span> <span class="st">"sf"</span>)</span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a>canada <span class="ot">&lt;-</span> <span class="fu">ne_states</span>(<span class="st">"canada"</span>, <span class="at">returnclass =</span> <span class="st">"sf"</span>)</span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a><span class="do">#### Functions  ####</span></span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate weighted mean &amp; median across biomass measures</span></span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a>weighted_df_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(var_col, ...){</span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a>  var_lab <span class="ot">&lt;-</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(var_col))</span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a>  mean_df <span class="ot">&lt;-</span> station_totals <span class="sc">%&gt;%</span> </span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(comname, ...) <span class="sc">%&gt;%</span> </span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">biom_median  =</span> <span class="fu">weightedMedian</span>({{var_col}}, biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">biom_mu      =</span> <span class="fu">weightedMean</span>({{var_col}},   biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">biom_sd      =</span> <span class="fu">weightedSd</span>({{var_col}}, biomass_kg, <span class="at">na.rm =</span> T), </span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">var =</span> var_lab)</span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(mean_df)</span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-83"><a href="#cb21-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-84"><a href="#cb21-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Weighted linear models to test significance between distributions</span></span>
<span id="cb21-85"><a href="#cb21-85" aria-hidden="true" tabindex="-1"></a><span class="co"># To test for difference in variable across regimes</span></span>
<span id="cb21-86"><a href="#cb21-86" aria-hidden="true" tabindex="-1"></a>test_signif <span class="ot">&lt;-</span> <span class="cf">function</span>(filter_species, dependent_var){</span>
<span id="cb21-87"><a href="#cb21-87" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-88"><a href="#cb21-88" aria-hidden="true" tabindex="-1"></a>  <span class="co"># formula for lm</span></span>
<span id="cb21-89"><a href="#cb21-89" aria-hidden="true" tabindex="-1"></a>  mod_form <span class="ot">&lt;-</span> <span class="fu">formula</span>(<span class="fu">paste</span>(dependent_var, <span class="st">"~ temp_regime"</span>))</span>
<span id="cb21-90"><a href="#cb21-90" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-91"><a href="#cb21-91" aria-hidden="true" tabindex="-1"></a>  <span class="co"># data for models</span></span>
<span id="cb21-92"><a href="#cb21-92" aria-hidden="true" tabindex="-1"></a>  mod_dat <span class="ot">&lt;-</span> station_totals <span class="sc">%&gt;%</span> </span>
<span id="cb21-93"><a href="#cb21-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(comname <span class="sc">==</span> filter_species) </span>
<span id="cb21-94"><a href="#cb21-94" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-95"><a href="#cb21-95" aria-hidden="true" tabindex="-1"></a>  <span class="co"># biomass weighted</span></span>
<span id="cb21-96"><a href="#cb21-96" aria-hidden="true" tabindex="-1"></a>  biom_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb21-97"><a href="#cb21-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">formula =</span> mod_form, </span>
<span id="cb21-98"><a href="#cb21-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> mod_dat, </span>
<span id="cb21-99"><a href="#cb21-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">weights =</span> <span class="fu">pull</span>(mod_dat, biomass_kg))</span>
<span id="cb21-100"><a href="#cb21-100" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-101"><a href="#cb21-101" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Grab Significance for both in table</span></span>
<span id="cb21-102"><a href="#cb21-102" aria-hidden="true" tabindex="-1"></a>  out_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-103"><a href="#cb21-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">biom_mod_p  =</span> broom<span class="sc">::</span><span class="fu">glance</span>(biom_lm)<span class="sc">$</span>p.value) <span class="sc">%&gt;%</span> </span>
<span id="cb21-104"><a href="#cb21-104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb21-105"><a href="#cb21-105" aria-hidden="true" tabindex="-1"></a>      <span class="at">comname =</span> filter_species,</span>
<span id="cb21-106"><a href="#cb21-106" aria-hidden="true" tabindex="-1"></a>      <span class="at">biom_signif  =</span> <span class="fu">ifelse</span>(biom_mod_p  <span class="sc">&lt;</span> <span class="fl">0.05</span>, T, F))</span>
<span id="cb21-107"><a href="#cb21-107" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-108"><a href="#cb21-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames</span>(out_table) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb21-109"><a href="#cb21-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out_table)</span>
<span id="cb21-110"><a href="#cb21-110" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-111"><a href="#cb21-111" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-112"><a href="#cb21-112" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-113"><a href="#cb21-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-114"><a href="#cb21-114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-115"><a href="#cb21-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-116"><a href="#cb21-116" aria-hidden="true" tabindex="-1"></a><span class="in">`r gmRi::use_gmri_style_rmd(css_file = "gmri_rmarkdown.css")`</span></span>
<span id="cb21-117"><a href="#cb21-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-118"><a href="#cb21-118" aria-hidden="true" tabindex="-1"></a><span class="fu">### Species Used:</span></span>
<span id="cb21-119"><a href="#cb21-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-120"><a href="#cb21-120" aria-hidden="true" tabindex="-1"></a>The species used here will match the 16 species included as part of the size-at-age analysis. Those species are:</span>
<span id="cb21-121"><a href="#cb21-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-124"><a href="#cb21-124" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-125"><a href="#cb21-125" aria-hidden="true" tabindex="-1"></a><span class="co"># Size at age species</span></span>
<span id="cb21-126"><a href="#cb21-126" aria-hidden="true" tabindex="-1"></a>saa_species <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"acadian redfish"</span>, <span class="st">"american plaice"</span>, </span>
<span id="cb21-127"><a href="#cb21-127" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"atlantic cod"</span>, <span class="st">"atlantic herring"</span>, </span>
<span id="cb21-128"><a href="#cb21-128" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"atlantic mackerel"</span>, <span class="st">"black sea bass"</span>, </span>
<span id="cb21-129"><a href="#cb21-129" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"butterfish"</span>, <span class="st">"haddock"</span>, <span class="st">"pollock"</span>, <span class="st">"red hake"</span>, </span>
<span id="cb21-130"><a href="#cb21-130" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"scup"</span>, <span class="st">"silver hake"</span>, <span class="st">"summer flounder"</span>, </span>
<span id="cb21-131"><a href="#cb21-131" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"white hake"</span>, <span class="st">"winter flounder"</span>, </span>
<span id="cb21-132"><a href="#cb21-132" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"witch flounder"</span>, <span class="st">"yellowtail flounder"</span>)</span>
<span id="cb21-133"><a href="#cb21-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-134"><a href="#cb21-134" aria-hidden="true" tabindex="-1"></a><span class="co"># table for printing</span></span>
<span id="cb21-135"><a href="#cb21-135" aria-hidden="true" tabindex="-1"></a>spec_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"Species"</span> <span class="ot">=</span> saa_species)</span>
<span id="cb21-136"><a href="#cb21-136" aria-hidden="true" tabindex="-1"></a>spec_df <span class="sc">%&gt;%</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb21-137"><a href="#cb21-137" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-138"><a href="#cb21-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-139"><a href="#cb21-139" aria-hidden="true" tabindex="-1"></a>Data for these <span class="in">`r nrow(spec_df)`</span> species comes from fisheries independent trawl survey data collected by NOAA and the NEFSC.</span>
<span id="cb21-140"><a href="#cb21-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-141"><a href="#cb21-141" aria-hidden="true" tabindex="-1"></a><span class="in">```{r data prep}</span></span>
<span id="cb21-142"><a href="#cb21-142" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the regional temperatures from {targets}</span></span>
<span id="cb21-143"><a href="#cb21-143" aria-hidden="true" tabindex="-1"></a>withr<span class="sc">::</span><span class="fu">with_dir</span>(rprojroot<span class="sc">::</span><span class="fu">find_root</span>(<span class="st">'_targets.R'</span>), </span>
<span id="cb21-144"><a href="#cb21-144" aria-hidden="true" tabindex="-1"></a>                <span class="fu">tar_load</span>(nefsc_stratified))</span>
<span id="cb21-145"><a href="#cb21-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-146"><a href="#cb21-146" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to just them, and the two time regimes</span></span>
<span id="cb21-147"><a href="#cb21-147" aria-hidden="true" tabindex="-1"></a>trawldat <span class="ot">&lt;-</span> nefsc_stratified <span class="sc">%&gt;%</span> </span>
<span id="cb21-148"><a href="#cb21-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(comname <span class="sc">%in%</span> saa_species,</span>
<span id="cb21-149"><a href="#cb21-149" aria-hidden="true" tabindex="-1"></a>         est_year <span class="sc">&gt;=</span> <span class="dv">2000</span>)</span>
<span id="cb21-150"><a href="#cb21-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-151"><a href="#cb21-151" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull the main columns to speed things up</span></span>
<span id="cb21-152"><a href="#cb21-152" aria-hidden="true" tabindex="-1"></a>trawldat <span class="ot">&lt;-</span> trawldat <span class="sc">%&gt;%</span> </span>
<span id="cb21-153"><a href="#cb21-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(cruise6, station, stratum, tow, survey_area,</span>
<span id="cb21-154"><a href="#cb21-154" aria-hidden="true" tabindex="-1"></a>         svvessel, source, est_year, est_towdate,</span>
<span id="cb21-155"><a href="#cb21-155" aria-hidden="true" tabindex="-1"></a>         season, decdeg_beglat, decdeg_beglon, </span>
<span id="cb21-156"><a href="#cb21-156" aria-hidden="true" tabindex="-1"></a>         avgdepth, bottemp, comname, scientific_name,</span>
<span id="cb21-157"><a href="#cb21-157" aria-hidden="true" tabindex="-1"></a>         abundance, biomass_kg, </span>
<span id="cb21-158"><a href="#cb21-158" aria-hidden="true" tabindex="-1"></a>         catchsex, sum_weight_kg)</span>
<span id="cb21-159"><a href="#cb21-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-160"><a href="#cb21-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-161"><a href="#cb21-161" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up the regimes</span></span>
<span id="cb21-162"><a href="#cb21-162" aria-hidden="true" tabindex="-1"></a>trawldat <span class="ot">&lt;-</span> trawldat <span class="sc">%&gt;%</span> </span>
<span id="cb21-163"><a href="#cb21-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(est_year, <span class="dv">2000</span>, <span class="dv">2019</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-164"><a href="#cb21-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">temp_regime =</span> <span class="fu">ifelse</span>(est_year <span class="sc">&lt;</span> <span class="dv">2010</span>, <span class="st">"Early Regime"</span>, <span class="st">"Warm Regime"</span>))</span>
<span id="cb21-165"><a href="#cb21-165" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-166"><a href="#cb21-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-167"><a href="#cb21-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-168"><a href="#cb21-168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r summary totals}</span></span>
<span id="cb21-169"><a href="#cb21-169" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize to total biomass per tow:</span></span>
<span id="cb21-170"><a href="#cb21-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-171"><a href="#cb21-171" aria-hidden="true" tabindex="-1"></a><span class="do">####  WORKING HERE  ####</span></span>
<span id="cb21-172"><a href="#cb21-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-173"><a href="#cb21-173" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. station_totals = biomass and abundance from each tow for all species</span></span>
<span id="cb21-174"><a href="#cb21-174" aria-hidden="true" tabindex="-1"></a><span class="co"># Totals up the abundance and biomass across sex*</span></span>
<span id="cb21-175"><a href="#cb21-175" aria-hidden="true" tabindex="-1"></a>station_totals <span class="ot">&lt;-</span> trawldat <span class="sc">%&gt;%</span> </span>
<span id="cb21-176"><a href="#cb21-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(est_year, survey_area, stratum, tow, est_towdate, avgdepth, bottemp, decdeg_beglat, decdeg_beglon, temp_regime, comname) <span class="sc">%&gt;%</span> </span>
<span id="cb21-177"><a href="#cb21-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb21-178"><a href="#cb21-178" aria-hidden="true" tabindex="-1"></a>    <span class="at">biomass_kg =</span> <span class="fu">sum</span>(biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-179"><a href="#cb21-179" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb21-180"><a href="#cb21-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-181"><a href="#cb21-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-182"><a href="#cb21-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-183"><a href="#cb21-183" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. yrly_avgs = average and sd of biomass </span></span>
<span id="cb21-184"><a href="#cb21-184" aria-hidden="true" tabindex="-1"></a>year_avgs <span class="ot">&lt;-</span> station_totals <span class="sc">%&gt;%</span> </span>
<span id="cb21-185"><a href="#cb21-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(temp_regime, comname, est_year) <span class="sc">%&gt;%</span> </span>
<span id="cb21-186"><a href="#cb21-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb21-187"><a href="#cb21-187" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_biomass   =</span> <span class="fu">sum</span>(biomass_kg),</span>
<span id="cb21-188"><a href="#cb21-188" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_biomass     =</span> <span class="fu">mean</span>(biomass_kg),</span>
<span id="cb21-189"><a href="#cb21-189" aria-hidden="true" tabindex="-1"></a>    <span class="at">biomass_sd      =</span> <span class="fu">sd</span>(biomass_kg),</span>
<span id="cb21-190"><a href="#cb21-190" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_depth       =</span> <span class="fu">weightedMean</span>(avgdepth, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-191"><a href="#cb21-191" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_temp        =</span> <span class="fu">weightedMean</span>(bottemp, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-192"><a href="#cb21-192" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_lat         =</span> <span class="fu">weightedMean</span>(decdeg_beglat, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-193"><a href="#cb21-193" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_lon         =</span> <span class="fu">weightedMean</span>(decdeg_beglon, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-194"><a href="#cb21-194" aria-hidden="true" tabindex="-1"></a>    <span class="at">depth_sd        =</span> <span class="fu">weightedSd</span>(avgdepth, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-195"><a href="#cb21-195" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_sd         =</span> <span class="fu">weightedSd</span>(bottemp, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-196"><a href="#cb21-196" aria-hidden="true" tabindex="-1"></a>    <span class="at">lat_sd          =</span> <span class="fu">weightedSd</span>(decdeg_beglat, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-197"><a href="#cb21-197" aria-hidden="true" tabindex="-1"></a>    <span class="at">lon_sd          =</span> <span class="fu">weightedSd</span>(decdeg_beglon, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-198"><a href="#cb21-198" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb21-199"><a href="#cb21-199" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-200"><a href="#cb21-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-201"><a href="#cb21-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-202"><a href="#cb21-202" aria-hidden="true" tabindex="-1"></a><span class="co"># Same but the periods as a whole</span></span>
<span id="cb21-203"><a href="#cb21-203" aria-hidden="true" tabindex="-1"></a>regime_avgs <span class="ot">&lt;-</span> station_totals  <span class="sc">%&gt;%</span> </span>
<span id="cb21-204"><a href="#cb21-204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(temp_regime, comname) <span class="sc">%&gt;%</span> </span>
<span id="cb21-205"><a href="#cb21-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb21-206"><a href="#cb21-206" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_biomass   =</span> <span class="fu">sum</span>(biomass_kg),</span>
<span id="cb21-207"><a href="#cb21-207" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_biomass     =</span> <span class="fu">mean</span>(biomass_kg),</span>
<span id="cb21-208"><a href="#cb21-208" aria-hidden="true" tabindex="-1"></a>    <span class="at">biomass_sd      =</span> <span class="fu">sd</span>(biomass_kg),</span>
<span id="cb21-209"><a href="#cb21-209" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_depth       =</span> <span class="fu">weightedMean</span>(avgdepth, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-210"><a href="#cb21-210" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_temp        =</span> <span class="fu">weightedMean</span>(bottemp, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-211"><a href="#cb21-211" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_lat         =</span> <span class="fu">weightedMean</span>(decdeg_beglat, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-212"><a href="#cb21-212" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_lon         =</span> <span class="fu">weightedMean</span>(decdeg_beglon, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-213"><a href="#cb21-213" aria-hidden="true" tabindex="-1"></a>    <span class="at">depth_sd        =</span> <span class="fu">weightedSd</span>(avgdepth, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-214"><a href="#cb21-214" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_sd         =</span> <span class="fu">weightedSd</span>(bottemp, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-215"><a href="#cb21-215" aria-hidden="true" tabindex="-1"></a>    <span class="at">lat_sd          =</span> <span class="fu">weightedSd</span>(decdeg_beglat, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-216"><a href="#cb21-216" aria-hidden="true" tabindex="-1"></a>    <span class="at">lon_sd          =</span> <span class="fu">weightedSd</span>(decdeg_beglon, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-217"><a href="#cb21-217" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb21-218"><a href="#cb21-218" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-219"><a href="#cb21-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-220"><a href="#cb21-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-221"><a href="#cb21-221" aria-hidden="true" tabindex="-1"></a><span class="do">####  ROAD BLOCK  ####</span></span>
<span id="cb21-222"><a href="#cb21-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-223"><a href="#cb21-223" aria-hidden="true" tabindex="-1"></a><span class="co"># What is the reference point to standardize against?</span></span>
<span id="cb21-224"><a href="#cb21-224" aria-hidden="true" tabindex="-1"></a><span class="co"># option 1: what is the variance in station measurements</span></span>
<span id="cb21-225"><a href="#cb21-225" aria-hidden="true" tabindex="-1"></a><span class="co"># option 2: weight that by the biomass there? no, right?</span></span>
<span id="cb21-226"><a href="#cb21-226" aria-hidden="true" tabindex="-1"></a><span class="co"># variance within a period, or overall</span></span>
<span id="cb21-227"><a href="#cb21-227" aria-hidden="true" tabindex="-1"></a><span class="co"># Variance specific for each species, ya?</span></span>
<span id="cb21-228"><a href="#cb21-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-229"><a href="#cb21-229" aria-hidden="true" tabindex="-1"></a><span class="co"># Variance across all years within each species</span></span>
<span id="cb21-230"><a href="#cb21-230" aria-hidden="true" tabindex="-1"></a>global_benchmarks <span class="ot">&lt;-</span> station_totals <span class="sc">%&gt;%</span> </span>
<span id="cb21-231"><a href="#cb21-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(comname) <span class="sc">%&gt;%</span> </span>
<span id="cb21-232"><a href="#cb21-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb21-233"><a href="#cb21-233" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_biomass     =</span> <span class="fu">mean</span>(biomass_kg),</span>
<span id="cb21-234"><a href="#cb21-234" aria-hidden="true" tabindex="-1"></a>    <span class="at">biomass_sd      =</span> <span class="fu">sd</span>(biomass_kg),</span>
<span id="cb21-235"><a href="#cb21-235" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_depth       =</span> <span class="fu">weightedMean</span>(avgdepth, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-236"><a href="#cb21-236" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_temp        =</span> <span class="fu">weightedMean</span>(bottemp, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-237"><a href="#cb21-237" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_lat         =</span> <span class="fu">weightedMean</span>(decdeg_beglat, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-238"><a href="#cb21-238" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_lon         =</span> <span class="fu">weightedMean</span>(decdeg_beglon, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-239"><a href="#cb21-239" aria-hidden="true" tabindex="-1"></a>    <span class="at">depth_sd        =</span> <span class="fu">weightedSd</span>(avgdepth, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-240"><a href="#cb21-240" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp_sd         =</span> <span class="fu">weightedSd</span>(bottemp, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-241"><a href="#cb21-241" aria-hidden="true" tabindex="-1"></a>    <span class="at">lat_sd          =</span> <span class="fu">weightedSd</span>(decdeg_beglat, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-242"><a href="#cb21-242" aria-hidden="true" tabindex="-1"></a>    <span class="at">lon_sd          =</span> <span class="fu">weightedSd</span>(decdeg_beglon, <span class="at">w =</span> biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-243"><a href="#cb21-243" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb21-244"><a href="#cb21-244" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-245"><a href="#cb21-245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-246"><a href="#cb21-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-247"><a href="#cb21-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-248"><a href="#cb21-248" aria-hidden="true" tabindex="-1"></a><span class="in">```{r old weighting}</span></span>
<span id="cb21-249"><a href="#cb21-249" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval = FALSE</span></span>
<span id="cb21-250"><a href="#cb21-250" aria-hidden="true" tabindex="-1"></a><span class="do">####  Old code</span></span>
<span id="cb21-251"><a href="#cb21-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-252"><a href="#cb21-252" aria-hidden="true" tabindex="-1"></a><span class="co"># Standardize the biomass by what the total catch was that period</span></span>
<span id="cb21-253"><a href="#cb21-253" aria-hidden="true" tabindex="-1"></a><span class="co"># These are then used as weights for mean/median estimates</span></span>
<span id="cb21-254"><a href="#cb21-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-255"><a href="#cb21-255" aria-hidden="true" tabindex="-1"></a><span class="co"># Un-Stratified abundance</span></span>
<span id="cb21-256"><a href="#cb21-256" aria-hidden="true" tabindex="-1"></a><span class="co"># Un-Stratified length-weight biomass</span></span>
<span id="cb21-257"><a href="#cb21-257" aria-hidden="true" tabindex="-1"></a><span class="co"># Un-stratified, all-size Biomass</span></span>
<span id="cb21-258"><a href="#cb21-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-259"><a href="#cb21-259" aria-hidden="true" tabindex="-1"></a><span class="co"># trawldat &lt;- trawldat %&gt;%</span></span>
<span id="cb21-260"><a href="#cb21-260" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(comname, temp_regime) %&gt;%</span></span>
<span id="cb21-261"><a href="#cb21-261" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(</span></span>
<span id="cb21-262"><a href="#cb21-262" aria-hidden="true" tabindex="-1"></a><span class="co">#     group_abund = sum(numlen_adj, na.rm = T),</span></span>
<span id="cb21-263"><a href="#cb21-263" aria-hidden="true" tabindex="-1"></a><span class="co">#     group_bio   = sum(biom_per_lclass,  na.rm = T)) %&gt;%</span></span>
<span id="cb21-264"><a href="#cb21-264" aria-hidden="true" tabindex="-1"></a><span class="co">#   ungroup() %&gt;%</span></span>
<span id="cb21-265"><a href="#cb21-265" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(</span></span>
<span id="cb21-266"><a href="#cb21-266" aria-hidden="true" tabindex="-1"></a><span class="co">#     abund_wt    = numlen_adj / group_abund,</span></span>
<span id="cb21-267"><a href="#cb21-267" aria-hidden="true" tabindex="-1"></a><span class="co">#     biom_wt     = biom_per_lclass / group_bio,</span></span>
<span id="cb21-268"><a href="#cb21-268" aria-hidden="true" tabindex="-1"></a><span class="co">#     temp_regime = factor(temp_regime, levels = c("Early Regime", "Warm Regime")))</span></span>
<span id="cb21-269"><a href="#cb21-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-270"><a href="#cb21-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-271"><a href="#cb21-271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-272"><a href="#cb21-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-273"><a href="#cb21-273" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bottom Temperatures</span></span>
<span id="cb21-274"><a href="#cb21-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-275"><a href="#cb21-275" aria-hidden="true" tabindex="-1"></a>Using the bottom temperatures sampled before each tow, and the biomass caught at each tow, the following weighted distributions can be generated for what the conditions were at each location these species were caught.</span>
<span id="cb21-276"><a href="#cb21-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-279"><a href="#cb21-279" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-280"><a href="#cb21-280" aria-hidden="true" tabindex="-1"></a><span class="co"># What were temps doing over the whole region:</span></span>
<span id="cb21-281"><a href="#cb21-281" aria-hidden="true" tabindex="-1"></a>oisst_all <span class="ot">&lt;-</span> <span class="fu">oisst_access_timeseries</span>(<span class="st">"nmfs_trawl_regions"</span>, <span class="at">poly_name =</span> <span class="st">"inuse strata"</span>, <span class="at">mac_os =</span> <span class="st">"mojave"</span>)</span>
<span id="cb21-282"><a href="#cb21-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-283"><a href="#cb21-283" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Yearly averages</span></span>
<span id="cb21-284"><a href="#cb21-284" aria-hidden="true" tabindex="-1"></a>oisst_yrs <span class="ot">&lt;-</span> oisst_all <span class="sc">%&gt;%</span> </span>
<span id="cb21-285"><a href="#cb21-285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">as.Date</span>(time)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-286"><a href="#cb21-286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(time)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-287"><a href="#cb21-287" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb21-288"><a href="#cb21-288" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp =</span> <span class="fu">mean</span>(area_wtd_sst),</span>
<span id="cb21-289"><a href="#cb21-289" aria-hidden="true" tabindex="-1"></a>    <span class="at">clim =</span> <span class="fu">mean</span>(area_wtd_clim),</span>
<span id="cb21-290"><a href="#cb21-290" aria-hidden="true" tabindex="-1"></a>    <span class="at">anom =</span> <span class="fu">mean</span>(area_wtd_anom)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-291"><a href="#cb21-291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(year, <span class="dv">2000</span>, <span class="dv">2019</span>))</span>
<span id="cb21-292"><a href="#cb21-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-293"><a href="#cb21-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-294"><a href="#cb21-294" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(oisst_yrs, <span class="fu">aes</span>(year, anom)) <span class="sc">+</span></span>
<span id="cb21-295"><a href="#cb21-295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb21-296"><a href="#cb21-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="fu">gmri_cols</span>(<span class="st">"gmri blue"</span>)) <span class="sc">+</span></span>
<span id="cb21-297"><a href="#cb21-297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Survey Area Temperature Anomalies"</span>,</span>
<span id="cb21-298"><a href="#cb21-298" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Year"</span>,</span>
<span id="cb21-299"><a href="#cb21-299" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Temperature Anomaly Â°C"</span>)</span>
<span id="cb21-300"><a href="#cb21-300" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-301"><a href="#cb21-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-302"><a href="#cb21-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-303"><a href="#cb21-303" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb21-304"><a href="#cb21-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-305"><a href="#cb21-305" aria-hidden="true" tabindex="-1"></a><span class="fu">### Yearly Movements</span></span>
<span id="cb21-306"><a href="#cb21-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-309"><a href="#cb21-309" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-310"><a href="#cb21-310" aria-hidden="true" tabindex="-1"></a><span class="co"># Yearly averages</span></span>
<span id="cb21-311"><a href="#cb21-311" aria-hidden="true" tabindex="-1"></a><span class="co"># Join and Scale by Global Averages</span></span>
<span id="cb21-312"><a href="#cb21-312" aria-hidden="true" tabindex="-1"></a>temp_yrly <span class="ot">&lt;-</span> <span class="fu">weighted_df_fun</span>(bottemp, est_year, temp_regime) <span class="sc">%&gt;%</span> </span>
<span id="cb21-313"><a href="#cb21-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(global_benchmarks, <span class="fu">c</span>(<span class="st">"comname"</span>, <span class="st">"avg_temp"</span>, <span class="st">"temp_sd"</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb21-314"><a href="#cb21-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">biom_z =</span> (biom_mu <span class="sc">-</span> avg_temp) <span class="sc">/</span> temp_sd) </span>
<span id="cb21-315"><a href="#cb21-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-316"><a href="#cb21-316" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Each timeline</span></span>
<span id="cb21-317"><a href="#cb21-317" aria-hidden="true" tabindex="-1"></a>temp_yrly <span class="sc">%&gt;%</span> </span>
<span id="cb21-318"><a href="#cb21-318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(est_year, biom_z, <span class="at">color =</span> temp_regime)) <span class="sc">+</span></span>
<span id="cb21-319"><a href="#cb21-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"Overall Average"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-320"><a href="#cb21-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">group =</span> comname), <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb21-321"><a href="#cb21-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb21-322"><a href="#cb21-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gmri</span>() <span class="sc">+</span></span>
<span id="cb21-323"><a href="#cb21-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb21-324"><a href="#cb21-324" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Shift in Bottom Temperatures of Catch Locations"</span>,</span>
<span id="cb21-325"><a href="#cb21-325" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Yearly averages weighted by biomass, scaled against all-year average."</span>,</span>
<span id="cb21-326"><a href="#cb21-326" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Bottom Temperature (z)"</span>,  </span>
<span id="cb21-327"><a href="#cb21-327" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb21-328"><a href="#cb21-328" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Time Period"</span>, </span>
<span id="cb21-329"><a href="#cb21-329" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Time Period"</span>) <span class="sc">+</span></span>
<span id="cb21-330"><a href="#cb21-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="co">#axis.text.y = element_blank(),</span></span>
<span id="cb21-331"><a href="#cb21-331" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb21-332"><a href="#cb21-332" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb21-333"><a href="#cb21-333" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb21-334"><a href="#cb21-334" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-335"><a href="#cb21-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-336"><a href="#cb21-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-337"><a href="#cb21-337" aria-hidden="true" tabindex="-1"></a><span class="fu">### Regime Averages</span></span>
<span id="cb21-338"><a href="#cb21-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-341"><a href="#cb21-341" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-342"><a href="#cb21-342" aria-hidden="true" tabindex="-1"></a><span class="co"># Run weighting function for bottom temp</span></span>
<span id="cb21-343"><a href="#cb21-343" aria-hidden="true" tabindex="-1"></a>temp_change <span class="ot">&lt;-</span> <span class="fu">weighted_df_fun</span>(bottemp, temp_regime) <span class="sc">%&gt;%</span> </span>
<span id="cb21-344"><a href="#cb21-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(global_benchmarks, <span class="fu">c</span>(<span class="st">"comname"</span>, <span class="st">"avg_temp"</span>, <span class="st">"temp_sd"</span>)), <span class="at">by =</span> <span class="st">"comname"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-345"><a href="#cb21-345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">biom_z =</span> (biom_mu <span class="sc">-</span> avg_temp) <span class="sc">/</span> temp_sd) </span>
<span id="cb21-346"><a href="#cb21-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-347"><a href="#cb21-347" aria-hidden="true" tabindex="-1"></a><span class="co"># Get results on significance</span></span>
<span id="cb21-348"><a href="#cb21-348" aria-hidden="true" tabindex="-1"></a>temp_results <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(</span>
<span id="cb21-349"><a href="#cb21-349" aria-hidden="true" tabindex="-1"></a>  <span class="at">.x =</span> saa_species, </span>
<span id="cb21-350"><a href="#cb21-350" aria-hidden="true" tabindex="-1"></a>  <span class="at">.f =</span> test_signif, </span>
<span id="cb21-351"><a href="#cb21-351" aria-hidden="true" tabindex="-1"></a>  <span class="at">dependent_var =</span> <span class="st">"bottemp"</span>)</span>
<span id="cb21-352"><a href="#cb21-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-353"><a href="#cb21-353" aria-hidden="true" tabindex="-1"></a><span class="co"># Get regime averages</span></span>
<span id="cb21-354"><a href="#cb21-354" aria-hidden="true" tabindex="-1"></a>temp_avgs <span class="ot">&lt;-</span> temp_change <span class="sc">%&gt;%</span> </span>
<span id="cb21-355"><a href="#cb21-355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(temp_regime) <span class="sc">%&gt;%</span> </span>
<span id="cb21-356"><a href="#cb21-356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb21-357"><a href="#cb21-357" aria-hidden="true" tabindex="-1"></a>    <span class="at">biom_avg =</span> <span class="fu">round</span>(<span class="fu">mean</span>(biom_mu),<span class="dv">2</span>),</span>
<span id="cb21-358"><a href="#cb21-358" aria-hidden="true" tabindex="-1"></a>    <span class="at">biom_med =</span> <span class="fu">round</span>(<span class="fu">mean</span>(biom_median), <span class="dv">2</span>)</span>
<span id="cb21-359"><a href="#cb21-359" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-360"><a href="#cb21-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-361"><a href="#cb21-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-362"><a href="#cb21-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-363"><a href="#cb21-363" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1. Weighted by Stratified Biomass</span></span>
<span id="cb21-364"><a href="#cb21-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-365"><a href="#cb21-365" aria-hidden="true" tabindex="-1"></a><span class="co"># And another df for connecting the points</span></span>
<span id="cb21-366"><a href="#cb21-366" aria-hidden="true" tabindex="-1"></a>mu_segment_df <span class="ot">&lt;-</span> temp_change <span class="sc">%&gt;%</span> </span>
<span id="cb21-367"><a href="#cb21-367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(comname, temp_regime, biom_mu) <span class="sc">%&gt;%</span> </span>
<span id="cb21-368"><a href="#cb21-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"temp_regime"</span>, </span>
<span id="cb21-369"><a href="#cb21-369" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="fu">c</span>(biom_mu)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-370"><a href="#cb21-370" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb21-371"><a href="#cb21-371" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Track the Change in mean Locations</span></span>
<span id="cb21-372"><a href="#cb21-372" aria-hidden="true" tabindex="-1"></a>      <span class="at">avg_shift =</span> <span class="st">`</span><span class="at">Warm Regime</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>,</span>
<span id="cb21-373"><a href="#cb21-373" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Reorder the species factors by mean temperature preference</span></span>
<span id="cb21-374"><a href="#cb21-374" aria-hidden="true" tabindex="-1"></a>      <span class="at">comname =</span> <span class="fu">fct_reorder</span>(comname, <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>, <span class="at">.fun =</span> median))</span>
<span id="cb21-375"><a href="#cb21-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-376"><a href="#cb21-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-377"><a href="#cb21-377" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder factor by warm-tolerance in Early regime</span></span>
<span id="cb21-378"><a href="#cb21-378" aria-hidden="true" tabindex="-1"></a>temp_change <span class="ot">&lt;-</span> temp_change <span class="sc">%&gt;%</span> </span>
<span id="cb21-379"><a href="#cb21-379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comname =</span> <span class="fu">factor</span>(comname, <span class="at">levels =</span> <span class="fu">levels</span>(mu_segment_df<span class="sc">$</span>comname)))</span>
<span id="cb21-380"><a href="#cb21-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-381"><a href="#cb21-381" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Density Plots for Each species</span></span>
<span id="cb21-382"><a href="#cb21-382" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb21-383"><a href="#cb21-383" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">geom_link</span>(<span class="at">data =</span> mu_segment_df,</span>
<span id="cb21-384"><a href="#cb21-384" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>,</span>
<span id="cb21-385"><a href="#cb21-385" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> <span class="st">`</span><span class="at">Warm Regime</span><span class="st">`</span>,</span>
<span id="cb21-386"><a href="#cb21-386" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb21-387"><a href="#cb21-387" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> <span class="dv">0</span>,</span>
<span id="cb21-388"><a href="#cb21-388" aria-hidden="true" tabindex="-1"></a>                   <span class="at">group =</span> comname,</span>
<span id="cb21-389"><a href="#cb21-389" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fu">stat</span>(index),</span>
<span id="cb21-390"><a href="#cb21-390" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"Warm Regime"</span>),</span>
<span id="cb21-391"><a href="#cb21-391" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.75</span>,</span>
<span id="cb21-392"><a href="#cb21-392" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb21-393"><a href="#cb21-393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> temp_change ,</span>
<span id="cb21-394"><a href="#cb21-394" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> biom_mu, </span>
<span id="cb21-395"><a href="#cb21-395" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> <span class="dv">0</span>, </span>
<span id="cb21-396"><a href="#cb21-396" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> temp_regime),</span>
<span id="cb21-397"><a href="#cb21-397" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb21-398"><a href="#cb21-398" aria-hidden="true" tabindex="-1"></a>             <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb21-399"><a href="#cb21-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(comname<span class="sc">~</span>.) <span class="sc">+</span></span>
<span id="cb21-400"><a href="#cb21-400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gmri</span>() <span class="sc">+</span></span>
<span id="cb21-401"><a href="#cb21-401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gmri</span>() <span class="sc">+</span></span>
<span id="cb21-402"><a href="#cb21-402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb21-403"><a href="#cb21-403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb21-404"><a href="#cb21-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb21-405"><a href="#cb21-405" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Shift in Bottom Temperatures of Catch Locations"</span>,</span>
<span id="cb21-406"><a href="#cb21-406" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Biomass-weighted averages shown as points."</span>,</span>
<span id="cb21-407"><a href="#cb21-407" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">""</span>,  </span>
<span id="cb21-408"><a href="#cb21-408" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Bottom Temperature \u00b0C"</span>, </span>
<span id="cb21-409"><a href="#cb21-409" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Time Period"</span>, </span>
<span id="cb21-410"><a href="#cb21-410" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Time Period"</span>) <span class="sc">+</span></span>
<span id="cb21-411"><a href="#cb21-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb21-412"><a href="#cb21-412" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb21-413"><a href="#cb21-413" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb21-414"><a href="#cb21-414" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-415"><a href="#cb21-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-416"><a href="#cb21-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-417"><a href="#cb21-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-418"><a href="#cb21-418" aria-hidden="true" tabindex="-1"></a><span class="fu">### Relative Shifts</span></span>
<span id="cb21-419"><a href="#cb21-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-420"><a href="#cb21-420" aria-hidden="true" tabindex="-1"></a>For the following figure, the average of each temperature regime was scaled against the weighed average and standard deviation across all years.</span>
<span id="cb21-421"><a href="#cb21-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-424"><a href="#cb21-424" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-425"><a href="#cb21-425" aria-hidden="true" tabindex="-1"></a><span class="co"># And another df for connecting the points</span></span>
<span id="cb21-426"><a href="#cb21-426" aria-hidden="true" tabindex="-1"></a>z_segment_df <span class="ot">&lt;-</span> temp_change <span class="sc">%&gt;%</span> </span>
<span id="cb21-427"><a href="#cb21-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(comname, temp_regime, biom_z) <span class="sc">%&gt;%</span> </span>
<span id="cb21-428"><a href="#cb21-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"temp_regime"</span>, </span>
<span id="cb21-429"><a href="#cb21-429" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="fu">c</span>(biom_z)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-430"><a href="#cb21-430" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb21-431"><a href="#cb21-431" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Track the Change in mean Locations</span></span>
<span id="cb21-432"><a href="#cb21-432" aria-hidden="true" tabindex="-1"></a>      <span class="at">avg_shift =</span> <span class="st">`</span><span class="at">Warm Regime</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>,</span>
<span id="cb21-433"><a href="#cb21-433" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Reorder the species factors to match the previous plots</span></span>
<span id="cb21-434"><a href="#cb21-434" aria-hidden="true" tabindex="-1"></a>      <span class="at">comname =</span> <span class="fu">factor</span>(comname, <span class="at">levels =</span> <span class="fu">levels</span>(temp_change<span class="sc">$</span>comname)))</span>
<span id="cb21-435"><a href="#cb21-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-436"><a href="#cb21-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-437"><a href="#cb21-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-438"><a href="#cb21-438" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Density Plots for Each species</span></span>
<span id="cb21-439"><a href="#cb21-439" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb21-440"><a href="#cb21-440" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">geom_link</span>(<span class="at">data =</span> z_segment_df,</span>
<span id="cb21-441"><a href="#cb21-441" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>,</span>
<span id="cb21-442"><a href="#cb21-442" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> <span class="st">`</span><span class="at">Warm Regime</span><span class="st">`</span>,</span>
<span id="cb21-443"><a href="#cb21-443" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="dv">0</span>,</span>
<span id="cb21-444"><a href="#cb21-444" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> <span class="dv">0</span>,</span>
<span id="cb21-445"><a href="#cb21-445" aria-hidden="true" tabindex="-1"></a>                   <span class="at">group =</span> comname,</span>
<span id="cb21-446"><a href="#cb21-446" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fu">stat</span>(index),</span>
<span id="cb21-447"><a href="#cb21-447" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"Warm Regime"</span>),</span>
<span id="cb21-448"><a href="#cb21-448" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.75</span>,</span>
<span id="cb21-449"><a href="#cb21-449" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb21-450"><a href="#cb21-450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> temp_change ,</span>
<span id="cb21-451"><a href="#cb21-451" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> biom_z, </span>
<span id="cb21-452"><a href="#cb21-452" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> <span class="dv">0</span>, </span>
<span id="cb21-453"><a href="#cb21-453" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> temp_regime),</span>
<span id="cb21-454"><a href="#cb21-454" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb21-455"><a href="#cb21-455" aria-hidden="true" tabindex="-1"></a>             <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb21-456"><a href="#cb21-456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(comname<span class="sc">~</span>.) <span class="sc">+</span></span>
<span id="cb21-457"><a href="#cb21-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gmri</span>() <span class="sc">+</span></span>
<span id="cb21-458"><a href="#cb21-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gmri</span>() <span class="sc">+</span></span>
<span id="cb21-459"><a href="#cb21-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb21-460"><a href="#cb21-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">by =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb21-461"><a href="#cb21-461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb21-462"><a href="#cb21-462" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Shift in Relative Bottom Temperatures"</span>,</span>
<span id="cb21-463"><a href="#cb21-463" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Standardized biomass-weighted averages shown as points."</span>,</span>
<span id="cb21-464"><a href="#cb21-464" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">""</span>,  </span>
<span id="cb21-465"><a href="#cb21-465" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Bottom Temperature (z)"</span>, </span>
<span id="cb21-466"><a href="#cb21-466" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Time Period"</span>, </span>
<span id="cb21-467"><a href="#cb21-467" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Time Period"</span>) <span class="sc">+</span></span>
<span id="cb21-468"><a href="#cb21-468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb21-469"><a href="#cb21-469" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb21-470"><a href="#cb21-470" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb21-471"><a href="#cb21-471" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-472"><a href="#cb21-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-473"><a href="#cb21-473" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb21-474"><a href="#cb21-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-475"><a href="#cb21-475" aria-hidden="true" tabindex="-1"></a><span class="fu">### Temperature Summary</span></span>
<span id="cb21-476"><a href="#cb21-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-477"><a href="#cb21-477" aria-hidden="true" tabindex="-1"></a>Across all species the average temperature (by biomass) has increased from <span class="in">`r temp_avgs[temp_avgs$temp_regime == "Early Regime", 2][[1]]`</span> to <span class="in">`r temp_avgs[temp_avgs$temp_regime == "Warm Regime", 2][[1]]`</span> for a change in <span class="in">`r diff(temp_avgs$biom_avg)`</span>Â°C. </span>
<span id="cb21-478"><a href="#cb21-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-479"><a href="#cb21-479" aria-hidden="true" tabindex="-1"></a><span class="in">`r sum(temp_results$biom_signif)`</span> of the <span class="in">`r length(saa_species)`</span> showed a significant change in temperature among the different regimes indicating a change in habitat conditions regardless of avoidance strategy.</span>
<span id="cb21-480"><a href="#cb21-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-481"><a href="#cb21-481" aria-hidden="true" tabindex="-1"></a>In the following figure the biomass densities for the early and warm temperature regimes are shown for each species. The distributions are weighted by biomass of catch at each location. The weighed means are also shown for each regime.</span>
<span id="cb21-482"><a href="#cb21-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-483"><a href="#cb21-483" aria-hidden="true" tabindex="-1"></a><span class="fu">## Center of Latitude</span></span>
<span id="cb21-484"><a href="#cb21-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-485"><a href="#cb21-485" aria-hidden="true" tabindex="-1"></a>The (weighted) centers of latitude give an indication of whether a species is shifting its location Northward or Southward.</span>
<span id="cb21-486"><a href="#cb21-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-487"><a href="#cb21-487" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb21-488"><a href="#cb21-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-489"><a href="#cb21-489" aria-hidden="true" tabindex="-1"></a><span class="fu">### Yearly Movements</span></span>
<span id="cb21-490"><a href="#cb21-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-493"><a href="#cb21-493" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-494"><a href="#cb21-494" aria-hidden="true" tabindex="-1"></a><span class="co"># Weighted mean Locations</span></span>
<span id="cb21-495"><a href="#cb21-495" aria-hidden="true" tabindex="-1"></a>lat_yrly <span class="ot">&lt;-</span> <span class="fu">weighted_df_fun</span>(decdeg_beglat, est_year, temp_regime) <span class="sc">%&gt;%</span> </span>
<span id="cb21-496"><a href="#cb21-496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(global_benchmarks, <span class="fu">c</span>(<span class="st">"comname"</span>, <span class="st">"avg_lat"</span>, <span class="st">"lat_sd"</span>)), <span class="at">by =</span> <span class="st">"comname"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-497"><a href="#cb21-497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">biom_z =</span> (biom_mu <span class="sc">-</span> avg_lat) <span class="sc">/</span> lat_sd) </span>
<span id="cb21-498"><a href="#cb21-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-499"><a href="#cb21-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-500"><a href="#cb21-500" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Each timeline</span></span>
<span id="cb21-501"><a href="#cb21-501" aria-hidden="true" tabindex="-1"></a>lat_yrly <span class="sc">%&gt;%</span> </span>
<span id="cb21-502"><a href="#cb21-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(est_year, biom_z, <span class="at">color =</span> temp_regime)) <span class="sc">+</span></span>
<span id="cb21-503"><a href="#cb21-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"Overall Average"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-504"><a href="#cb21-504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">group =</span> comname), <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb21-505"><a href="#cb21-505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb21-506"><a href="#cb21-506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gmri</span>() <span class="sc">+</span></span>
<span id="cb21-507"><a href="#cb21-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb21-508"><a href="#cb21-508" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Shift in Latitude of Catch Locations"</span>,</span>
<span id="cb21-509"><a href="#cb21-509" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Yearly averages weighted by biomass, scaled against all-year average."</span>,</span>
<span id="cb21-510"><a href="#cb21-510" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Center of Biomass Latitude (z)"</span>,  </span>
<span id="cb21-511"><a href="#cb21-511" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb21-512"><a href="#cb21-512" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Time Period"</span>, </span>
<span id="cb21-513"><a href="#cb21-513" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Time Period"</span>) <span class="sc">+</span></span>
<span id="cb21-514"><a href="#cb21-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="co">#axis.text.y = element_blank(),</span></span>
<span id="cb21-515"><a href="#cb21-515" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb21-516"><a href="#cb21-516" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb21-517"><a href="#cb21-517" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-518"><a href="#cb21-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-519"><a href="#cb21-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-520"><a href="#cb21-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-521"><a href="#cb21-521" aria-hidden="true" tabindex="-1"></a><span class="fu">### Regime Averages</span></span>
<span id="cb21-522"><a href="#cb21-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-525"><a href="#cb21-525" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-526"><a href="#cb21-526" aria-hidden="true" tabindex="-1"></a><span class="co"># Weighted mean Locations</span></span>
<span id="cb21-527"><a href="#cb21-527" aria-hidden="true" tabindex="-1"></a>lat_change <span class="ot">&lt;-</span> <span class="fu">weighted_df_fun</span>(decdeg_beglat, temp_regime) <span class="sc">%&gt;%</span> </span>
<span id="cb21-528"><a href="#cb21-528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(global_benchmarks, <span class="fu">c</span>(<span class="st">"comname"</span>, <span class="st">"avg_lat"</span>, <span class="st">"lat_sd"</span>)), <span class="at">by =</span> <span class="st">"comname"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-529"><a href="#cb21-529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">biom_z =</span> (biom_mu <span class="sc">-</span> avg_lat) <span class="sc">/</span> lat_sd) </span>
<span id="cb21-530"><a href="#cb21-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-531"><a href="#cb21-531" aria-hidden="true" tabindex="-1"></a><span class="co"># Get regime averages</span></span>
<span id="cb21-532"><a href="#cb21-532" aria-hidden="true" tabindex="-1"></a>lat_avgs <span class="ot">&lt;-</span> lat_change <span class="sc">%&gt;%</span> </span>
<span id="cb21-533"><a href="#cb21-533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(temp_regime) <span class="sc">%&gt;%</span> </span>
<span id="cb21-534"><a href="#cb21-534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb21-535"><a href="#cb21-535" aria-hidden="true" tabindex="-1"></a>    <span class="at">biom_avg =</span> <span class="fu">round</span>(<span class="fu">mean</span>(biom_mu),<span class="dv">2</span>),</span>
<span id="cb21-536"><a href="#cb21-536" aria-hidden="true" tabindex="-1"></a>    <span class="at">biom_med =</span> <span class="fu">round</span>(<span class="fu">mean</span>(biom_median), <span class="dv">2</span>))</span>
<span id="cb21-537"><a href="#cb21-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-538"><a href="#cb21-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-539"><a href="#cb21-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-540"><a href="#cb21-540" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1. Weighted by Stratified Biomass</span></span>
<span id="cb21-541"><a href="#cb21-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-542"><a href="#cb21-542" aria-hidden="true" tabindex="-1"></a><span class="co"># And another df for connecting the points</span></span>
<span id="cb21-543"><a href="#cb21-543" aria-hidden="true" tabindex="-1"></a>lat_segment_df <span class="ot">&lt;-</span> lat_change <span class="sc">%&gt;%</span> </span>
<span id="cb21-544"><a href="#cb21-544" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(comname, temp_regime, biom_mu) <span class="sc">%&gt;%</span> </span>
<span id="cb21-545"><a href="#cb21-545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"temp_regime"</span>, </span>
<span id="cb21-546"><a href="#cb21-546" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="fu">c</span>(biom_mu)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-547"><a href="#cb21-547" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">avg_shift =</span> <span class="st">`</span><span class="at">Warm Regime</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>)</span>
<span id="cb21-548"><a href="#cb21-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-549"><a href="#cb21-549" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder the species factors by mean temperature preference</span></span>
<span id="cb21-550"><a href="#cb21-550" aria-hidden="true" tabindex="-1"></a>lat_segment_df <span class="ot">&lt;-</span> lat_segment_df <span class="sc">%&gt;%</span> </span>
<span id="cb21-551"><a href="#cb21-551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comname =</span> <span class="fu">fct_reorder</span>(comname, <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>, <span class="at">.fun =</span> median, <span class="at">.desc =</span> T))</span>
<span id="cb21-552"><a href="#cb21-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-553"><a href="#cb21-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-554"><a href="#cb21-554" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder factor by warm-tolerance in Early regime</span></span>
<span id="cb21-555"><a href="#cb21-555" aria-hidden="true" tabindex="-1"></a>lat_change <span class="ot">&lt;-</span> lat_change <span class="sc">%&gt;%</span> </span>
<span id="cb21-556"><a href="#cb21-556" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comname =</span> <span class="fu">factor</span>(comname, <span class="at">levels =</span> <span class="fu">levels</span>(lat_segment_df<span class="sc">$</span>comname)))</span>
<span id="cb21-557"><a href="#cb21-557" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb21-558"><a href="#cb21-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-559"><a href="#cb21-559" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a Plot of Major cities/landmarks for reference</span></span>
<span id="cb21-560"><a href="#cb21-560" aria-hidden="true" tabindex="-1"></a>lat_references <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-561"><a href="#cb21-561" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cities"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"NY, NY"</span>, <span class="st">"Chatham, MA"</span>, <span class="st">"Cape May, NJ"</span>),</span>
<span id="cb21-562"><a href="#cb21-562" aria-hidden="true" tabindex="-1"></a>  <span class="st">"lat"</span> <span class="ot">=</span> <span class="fu">c</span>( <span class="fl">40.72</span>,  <span class="fl">41.68</span>, <span class="fl">38.93</span>) )</span>
<span id="cb21-563"><a href="#cb21-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-564"><a href="#cb21-564" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Latitude Change with City References</span></span>
<span id="cb21-565"><a href="#cb21-565" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()  <span class="sc">+</span></span>
<span id="cb21-566"><a href="#cb21-566" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_link</span>(<span class="at">data =</span> lat_segment_df,</span>
<span id="cb21-567"><a href="#cb21-567" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">y =</span> <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>,</span>
<span id="cb21-568"><a href="#cb21-568" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> <span class="st">`</span><span class="at">Warm Regime</span><span class="st">`</span>,</span>
<span id="cb21-569"><a href="#cb21-569" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> comname,</span>
<span id="cb21-570"><a href="#cb21-570" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> comname,<span class="at">group =</span> comname,</span>
<span id="cb21-571"><a href="#cb21-571" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fu">stat</span>(index),</span>
<span id="cb21-572"><a href="#cb21-572" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"Warm Regime"</span>),</span>
<span id="cb21-573"><a href="#cb21-573" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.75</span>,</span>
<span id="cb21-574"><a href="#cb21-574" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb21-575"><a href="#cb21-575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> lat_change ,</span>
<span id="cb21-576"><a href="#cb21-576" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> comname, </span>
<span id="cb21-577"><a href="#cb21-577" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> biom_mu, </span>
<span id="cb21-578"><a href="#cb21-578" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> temp_regime),</span>
<span id="cb21-579"><a href="#cb21-579" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb21-580"><a href="#cb21-580" aria-hidden="true" tabindex="-1"></a>             <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb21-581"><a href="#cb21-581" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_hline(data = lat_references, aes(yintercept = lat), color = "gray60") +</span></span>
<span id="cb21-582"><a href="#cb21-582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> lat_references, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">3.5</span>, <span class="at">label =</span> cities, <span class="at">y =</span> lat)) <span class="sc">+</span></span>
<span id="cb21-583"><a href="#cb21-583" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gmri</span>() <span class="sc">+</span></span>
<span id="cb21-584"><a href="#cb21-584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gmri</span>() <span class="sc">+</span></span>
<span id="cb21-585"><a href="#cb21-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">30</span>, <span class="dv">60</span>, <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb21-586"><a href="#cb21-586" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb21-587"><a href="#cb21-587" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Shift in Center of Biomass Latitudes"</span>,</span>
<span id="cb21-588"><a href="#cb21-588" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Distributions weighted by biomass, weighted means shown as points."</span>,</span>
<span id="cb21-589"><a href="#cb21-589" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Center of Biomass Latitude \u00b0N"</span>,  </span>
<span id="cb21-590"><a href="#cb21-590" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb21-591"><a href="#cb21-591" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Time Period"</span>, </span>
<span id="cb21-592"><a href="#cb21-592" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Time Period"</span>) <span class="sc">+</span></span>
<span id="cb21-593"><a href="#cb21-593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb21-594"><a href="#cb21-594" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb21-595"><a href="#cb21-595" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb21-596"><a href="#cb21-596" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-597"><a href="#cb21-597" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-598"><a href="#cb21-598" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-599"><a href="#cb21-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-600"><a href="#cb21-600" aria-hidden="true" tabindex="-1"></a>Species showing the largest latitudinal shifts include Atlantic mackerel, scup, and Black Sea Bass. These species all have center of biomass latitudes South of Cape Cod, and have some of the largest potential for Northward movements within the survey area.</span>
<span id="cb21-601"><a href="#cb21-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-602"><a href="#cb21-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-603"><a href="#cb21-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-604"><a href="#cb21-604" aria-hidden="true" tabindex="-1"></a><span class="fu">### Relative Shifts</span></span>
<span id="cb21-605"><a href="#cb21-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-606"><a href="#cb21-606" aria-hidden="true" tabindex="-1"></a>For the following figure, the average of each temperature regime was scaled against the weighed average and standard deviation across all years.</span>
<span id="cb21-607"><a href="#cb21-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-610"><a href="#cb21-610" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-611"><a href="#cb21-611" aria-hidden="true" tabindex="-1"></a><span class="co"># And another df for connecting the points</span></span>
<span id="cb21-612"><a href="#cb21-612" aria-hidden="true" tabindex="-1"></a>z_segment_df <span class="ot">&lt;-</span> lat_change <span class="sc">%&gt;%</span> </span>
<span id="cb21-613"><a href="#cb21-613" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(comname, temp_regime, biom_z) <span class="sc">%&gt;%</span> </span>
<span id="cb21-614"><a href="#cb21-614" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"temp_regime"</span>, </span>
<span id="cb21-615"><a href="#cb21-615" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="fu">c</span>(biom_z)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-616"><a href="#cb21-616" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb21-617"><a href="#cb21-617" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Track the Change in mean Locations</span></span>
<span id="cb21-618"><a href="#cb21-618" aria-hidden="true" tabindex="-1"></a>      <span class="at">avg_shift =</span> <span class="st">`</span><span class="at">Warm Regime</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>,</span>
<span id="cb21-619"><a href="#cb21-619" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Reorder the species factors to match the previous plots</span></span>
<span id="cb21-620"><a href="#cb21-620" aria-hidden="true" tabindex="-1"></a>      <span class="at">comname =</span> <span class="fu">factor</span>(comname, <span class="at">levels =</span> <span class="fu">levels</span>(lat_change<span class="sc">$</span>comname)))</span>
<span id="cb21-621"><a href="#cb21-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-622"><a href="#cb21-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-623"><a href="#cb21-623" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Density Plots for Each species</span></span>
<span id="cb21-624"><a href="#cb21-624" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()  <span class="sc">+</span></span>
<span id="cb21-625"><a href="#cb21-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_link</span>(<span class="at">data =</span> z_segment_df,</span>
<span id="cb21-626"><a href="#cb21-626" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">y =</span> <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>,</span>
<span id="cb21-627"><a href="#cb21-627" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> <span class="st">`</span><span class="at">Warm Regime</span><span class="st">`</span>,</span>
<span id="cb21-628"><a href="#cb21-628" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> comname,</span>
<span id="cb21-629"><a href="#cb21-629" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> comname,<span class="at">group =</span> comname,</span>
<span id="cb21-630"><a href="#cb21-630" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fu">stat</span>(index),</span>
<span id="cb21-631"><a href="#cb21-631" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"Warm Regime"</span>),</span>
<span id="cb21-632"><a href="#cb21-632" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.75</span>,</span>
<span id="cb21-633"><a href="#cb21-633" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb21-634"><a href="#cb21-634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> lat_change ,</span>
<span id="cb21-635"><a href="#cb21-635" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> comname, </span>
<span id="cb21-636"><a href="#cb21-636" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> biom_z, </span>
<span id="cb21-637"><a href="#cb21-637" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> temp_regime),</span>
<span id="cb21-638"><a href="#cb21-638" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb21-639"><a href="#cb21-639" aria-hidden="true" tabindex="-1"></a>             <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb21-640"><a href="#cb21-640" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gmri</span>() <span class="sc">+</span></span>
<span id="cb21-641"><a href="#cb21-641" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gmri</span>() <span class="sc">+</span></span>
<span id="cb21-642"><a href="#cb21-642" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">by =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb21-643"><a href="#cb21-643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb21-644"><a href="#cb21-644" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Shift in Standardized Center of Biomass Latitudes"</span>,</span>
<span id="cb21-645"><a href="#cb21-645" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Distributions weighted by biomass, weighted means shown as points."</span>,</span>
<span id="cb21-646"><a href="#cb21-646" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Center of Biomass Latitude (z)"</span>,  </span>
<span id="cb21-647"><a href="#cb21-647" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb21-648"><a href="#cb21-648" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Time Period"</span>, </span>
<span id="cb21-649"><a href="#cb21-649" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Time Period"</span>) <span class="sc">+</span></span>
<span id="cb21-650"><a href="#cb21-650" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb21-651"><a href="#cb21-651" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb21-652"><a href="#cb21-652" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb21-653"><a href="#cb21-653" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-654"><a href="#cb21-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-655"><a href="#cb21-655" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb21-656"><a href="#cb21-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-657"><a href="#cb21-657" aria-hidden="true" tabindex="-1"></a><span class="fu">### Latitude Summary</span></span>
<span id="cb21-658"><a href="#cb21-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-659"><a href="#cb21-659" aria-hidden="true" tabindex="-1"></a>Across all species the average Latitude at capture has increased from <span class="in">`r lat_avgs[lat_avgs$temp_regime == "Early Regime", 2][[1]]`</span> to <span class="in">`r lat_avgs[lat_avgs$temp_regime == "Warm Regime", 2][[1]]`</span> for a change in <span class="in">`r diff(lat_avgs$biom_avg)`</span> Â° Latitude. </span>
<span id="cb21-660"><a href="#cb21-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-661"><a href="#cb21-661" aria-hidden="true" tabindex="-1"></a><span class="fu">## Capture Depth</span></span>
<span id="cb21-662"><a href="#cb21-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-663"><a href="#cb21-663" aria-hidden="true" tabindex="-1"></a>Depth is highly correlated with temperature and may be an avenue for species to follow their thermal preferences without moving Northward. If species are moving deeper without changing their temperature habitats this may suggest a different driver is at play.</span>
<span id="cb21-664"><a href="#cb21-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-665"><a href="#cb21-665" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb21-666"><a href="#cb21-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-667"><a href="#cb21-667" aria-hidden="true" tabindex="-1"></a><span class="fu">### Yearly Movements</span></span>
<span id="cb21-668"><a href="#cb21-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-671"><a href="#cb21-671" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-672"><a href="#cb21-672" aria-hidden="true" tabindex="-1"></a><span class="co"># Weighted mean Locations</span></span>
<span id="cb21-673"><a href="#cb21-673" aria-hidden="true" tabindex="-1"></a>depth_yrly <span class="ot">&lt;-</span> <span class="fu">weighted_df_fun</span>(avgdepth, est_year, temp_regime) <span class="sc">%&gt;%</span> </span>
<span id="cb21-674"><a href="#cb21-674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(global_benchmarks, <span class="fu">c</span>(<span class="st">"comname"</span>, <span class="st">"avg_depth"</span>, <span class="st">"depth_sd"</span>)), <span class="at">by =</span> <span class="st">"comname"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-675"><a href="#cb21-675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">biom_z =</span> (biom_mu <span class="sc">-</span> avg_depth) <span class="sc">/</span> depth_sd) </span>
<span id="cb21-676"><a href="#cb21-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-677"><a href="#cb21-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-678"><a href="#cb21-678" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Each timeline</span></span>
<span id="cb21-679"><a href="#cb21-679" aria-hidden="true" tabindex="-1"></a>depth_yrly <span class="sc">%&gt;%</span> </span>
<span id="cb21-680"><a href="#cb21-680" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(est_year, biom_z, <span class="at">color =</span> temp_regime)) <span class="sc">+</span></span>
<span id="cb21-681"><a href="#cb21-681" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"Overall Average"</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-682"><a href="#cb21-682" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">group =</span> comname), <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb21-683"><a href="#cb21-683" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb21-684"><a href="#cb21-684" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gmri</span>() <span class="sc">+</span></span>
<span id="cb21-685"><a href="#cb21-685" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb21-686"><a href="#cb21-686" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Shift in Depth of Catch Locations"</span>,</span>
<span id="cb21-687"><a href="#cb21-687" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Yearly averages weighted by biomass, scaled against all-year average."</span>,</span>
<span id="cb21-688"><a href="#cb21-688" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Center of Biomass Depth (z)"</span>,  </span>
<span id="cb21-689"><a href="#cb21-689" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb21-690"><a href="#cb21-690" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Time Period"</span>, </span>
<span id="cb21-691"><a href="#cb21-691" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Time Period"</span>) <span class="sc">+</span></span>
<span id="cb21-692"><a href="#cb21-692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="co">#axis.text.y = element_blank(),</span></span>
<span id="cb21-693"><a href="#cb21-693" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb21-694"><a href="#cb21-694" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb21-695"><a href="#cb21-695" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-696"><a href="#cb21-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-697"><a href="#cb21-697" aria-hidden="true" tabindex="-1"></a><span class="fu">### Regime Averages</span></span>
<span id="cb21-698"><a href="#cb21-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-701"><a href="#cb21-701" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-702"><a href="#cb21-702" aria-hidden="true" tabindex="-1"></a><span class="co"># Weighted mean Locations</span></span>
<span id="cb21-703"><a href="#cb21-703" aria-hidden="true" tabindex="-1"></a>depth_change <span class="ot">&lt;-</span> <span class="fu">weighted_df_fun</span>(avgdepth, temp_regime) <span class="sc">%&gt;%</span> </span>
<span id="cb21-704"><a href="#cb21-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(global_benchmarks, <span class="fu">c</span>(<span class="st">"comname"</span>, <span class="st">"avg_depth"</span>, <span class="st">"depth_sd"</span>)), <span class="at">by =</span> <span class="st">"comname"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-705"><a href="#cb21-705" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">biom_z =</span> (biom_mu <span class="sc">-</span> avg_depth) <span class="sc">/</span> depth_sd) </span>
<span id="cb21-706"><a href="#cb21-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-707"><a href="#cb21-707" aria-hidden="true" tabindex="-1"></a><span class="co"># Avg Depths </span></span>
<span id="cb21-708"><a href="#cb21-708" aria-hidden="true" tabindex="-1"></a>avg_depths <span class="ot">&lt;-</span> depth_change <span class="sc">%&gt;%</span> </span>
<span id="cb21-709"><a href="#cb21-709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(temp_regime) <span class="sc">%&gt;%</span> </span>
<span id="cb21-710"><a href="#cb21-710" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb21-711"><a href="#cb21-711" aria-hidden="true" tabindex="-1"></a>    <span class="at">biom_avg =</span> <span class="fu">round</span>(<span class="fu">mean</span>(biom_mu),<span class="dv">2</span>),</span>
<span id="cb21-712"><a href="#cb21-712" aria-hidden="true" tabindex="-1"></a>    <span class="at">biom_med =</span> <span class="fu">round</span>(<span class="fu">mean</span>(biom_median), <span class="dv">2</span>))</span>
<span id="cb21-713"><a href="#cb21-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-714"><a href="#cb21-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-715"><a href="#cb21-715" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1. Weighted by Stratified Biomass</span></span>
<span id="cb21-716"><a href="#cb21-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-717"><a href="#cb21-717" aria-hidden="true" tabindex="-1"></a><span class="co"># And another df for connecting the points</span></span>
<span id="cb21-718"><a href="#cb21-718" aria-hidden="true" tabindex="-1"></a>depth_segment_df <span class="ot">&lt;-</span> depth_change <span class="sc">%&gt;%</span> </span>
<span id="cb21-719"><a href="#cb21-719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(comname, temp_regime, biom_mu) <span class="sc">%&gt;%</span> </span>
<span id="cb21-720"><a href="#cb21-720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"temp_regime"</span>, </span>
<span id="cb21-721"><a href="#cb21-721" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="fu">c</span>(biom_mu)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-722"><a href="#cb21-722" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">avg_shift =</span> <span class="st">`</span><span class="at">Warm Regime</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>)</span>
<span id="cb21-723"><a href="#cb21-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-724"><a href="#cb21-724" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder the species factors by mean temperature preference</span></span>
<span id="cb21-725"><a href="#cb21-725" aria-hidden="true" tabindex="-1"></a>depth_segment_df <span class="ot">&lt;-</span> depth_segment_df <span class="sc">%&gt;%</span> </span>
<span id="cb21-726"><a href="#cb21-726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comname =</span> <span class="fu">fct_reorder</span>(comname, <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>, <span class="at">.fun =</span> median, <span class="at">.desc =</span> F))</span>
<span id="cb21-727"><a href="#cb21-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-728"><a href="#cb21-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-729"><a href="#cb21-729" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder factor by warm-tolerance in Early regime</span></span>
<span id="cb21-730"><a href="#cb21-730" aria-hidden="true" tabindex="-1"></a>depth_change <span class="ot">&lt;-</span> depth_change <span class="sc">%&gt;%</span> </span>
<span id="cb21-731"><a href="#cb21-731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">comname =</span> <span class="fu">factor</span>(comname, <span class="at">levels =</span> <span class="fu">levels</span>(depth_segment_df<span class="sc">$</span>comname)))</span>
<span id="cb21-732"><a href="#cb21-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-733"><a href="#cb21-733" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Density Plots for Each species</span></span>
<span id="cb21-734"><a href="#cb21-734" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb21-735"><a href="#cb21-735" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">geom_link</span>(<span class="at">data =</span> depth_segment_df,</span>
<span id="cb21-736"><a href="#cb21-736" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">y =</span> <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>,</span>
<span id="cb21-737"><a href="#cb21-737" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> <span class="st">`</span><span class="at">Warm Regime</span><span class="st">`</span>,</span>
<span id="cb21-738"><a href="#cb21-738" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> comname,</span>
<span id="cb21-739"><a href="#cb21-739" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> comname,</span>
<span id="cb21-740"><a href="#cb21-740" aria-hidden="true" tabindex="-1"></a>                   <span class="at">alpha =</span> <span class="fu">stat</span>(index),</span>
<span id="cb21-741"><a href="#cb21-741" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"Warm Regime"</span>),</span>
<span id="cb21-742"><a href="#cb21-742" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.75</span>,</span>
<span id="cb21-743"><a href="#cb21-743" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb21-744"><a href="#cb21-744" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> depth_change ,</span>
<span id="cb21-745"><a href="#cb21-745" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> biom_mu, </span>
<span id="cb21-746"><a href="#cb21-746" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x =</span> comname, </span>
<span id="cb21-747"><a href="#cb21-747" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> temp_regime),</span>
<span id="cb21-748"><a href="#cb21-748" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb21-749"><a href="#cb21-749" aria-hidden="true" tabindex="-1"></a>             <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb21-750"><a href="#cb21-750" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gmri</span>() <span class="sc">+</span></span>
<span id="cb21-751"><a href="#cb21-751" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gmri</span>() <span class="sc">+</span></span>
<span id="cb21-752"><a href="#cb21-752" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">300</span>, <span class="at">by =</span> <span class="dv">50</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">200</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb21-753"><a href="#cb21-753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb21-754"><a href="#cb21-754" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Shift in Depth of Catch Locations"</span>,</span>
<span id="cb21-755"><a href="#cb21-755" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Distributions weighted by stratified biomass, weighted means shown as points."</span>,</span>
<span id="cb21-756"><a href="#cb21-756" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>,  </span>
<span id="cb21-757"><a href="#cb21-757" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average Depth (m)"</span>, </span>
<span id="cb21-758"><a href="#cb21-758" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Time Period"</span>, </span>
<span id="cb21-759"><a href="#cb21-759" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Time Period"</span>) <span class="sc">+</span></span>
<span id="cb21-760"><a href="#cb21-760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb21-761"><a href="#cb21-761" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb21-762"><a href="#cb21-762" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-763"><a href="#cb21-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-764"><a href="#cb21-764" aria-hidden="true" tabindex="-1"></a><span class="fu">### Relative Shifts</span></span>
<span id="cb21-765"><a href="#cb21-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-768"><a href="#cb21-768" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-769"><a href="#cb21-769" aria-hidden="true" tabindex="-1"></a><span class="co"># And another df for connecting the points</span></span>
<span id="cb21-770"><a href="#cb21-770" aria-hidden="true" tabindex="-1"></a>z_segment_df <span class="ot">&lt;-</span> depth_change <span class="sc">%&gt;%</span> </span>
<span id="cb21-771"><a href="#cb21-771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(comname, temp_regime, biom_z) <span class="sc">%&gt;%</span> </span>
<span id="cb21-772"><a href="#cb21-772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"temp_regime"</span>, </span>
<span id="cb21-773"><a href="#cb21-773" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> <span class="fu">c</span>(biom_z)) <span class="sc">%&gt;%</span> </span>
<span id="cb21-774"><a href="#cb21-774" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb21-775"><a href="#cb21-775" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Track the Change in mean Locations</span></span>
<span id="cb21-776"><a href="#cb21-776" aria-hidden="true" tabindex="-1"></a>      <span class="at">avg_shift =</span> <span class="st">`</span><span class="at">Warm Regime</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>,</span>
<span id="cb21-777"><a href="#cb21-777" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Reorder the species factors to match the previous plots</span></span>
<span id="cb21-778"><a href="#cb21-778" aria-hidden="true" tabindex="-1"></a>      <span class="at">comname =</span> <span class="fu">factor</span>(comname, <span class="at">levels =</span> <span class="fu">levels</span>(depth_change<span class="sc">$</span>comname)))</span>
<span id="cb21-779"><a href="#cb21-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-780"><a href="#cb21-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-781"><a href="#cb21-781" aria-hidden="true" tabindex="-1"></a><span class="co"># Make Density Plots for Each species</span></span>
<span id="cb21-782"><a href="#cb21-782" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()  <span class="sc">+</span></span>
<span id="cb21-783"><a href="#cb21-783" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_link</span>(<span class="at">data =</span> z_segment_df,</span>
<span id="cb21-784"><a href="#cb21-784" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">y =</span> <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>,</span>
<span id="cb21-785"><a href="#cb21-785" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> <span class="st">`</span><span class="at">Warm Regime</span><span class="st">`</span>,</span>
<span id="cb21-786"><a href="#cb21-786" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x =</span> comname,</span>
<span id="cb21-787"><a href="#cb21-787" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> comname,<span class="at">group =</span> comname,</span>
<span id="cb21-788"><a href="#cb21-788" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fu">stat</span>(index),</span>
<span id="cb21-789"><a href="#cb21-789" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"Warm Regime"</span>),</span>
<span id="cb21-790"><a href="#cb21-790" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.75</span>,</span>
<span id="cb21-791"><a href="#cb21-791" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb21-792"><a href="#cb21-792" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> depth_change ,</span>
<span id="cb21-793"><a href="#cb21-793" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> comname, </span>
<span id="cb21-794"><a href="#cb21-794" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> biom_z, </span>
<span id="cb21-795"><a href="#cb21-795" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> temp_regime),</span>
<span id="cb21-796"><a href="#cb21-796" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb21-797"><a href="#cb21-797" aria-hidden="true" tabindex="-1"></a>             <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb21-798"><a href="#cb21-798" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gmri</span>() <span class="sc">+</span></span>
<span id="cb21-799"><a href="#cb21-799" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gmri</span>() <span class="sc">+</span></span>
<span id="cb21-800"><a href="#cb21-800" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">by =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb21-801"><a href="#cb21-801" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb21-802"><a href="#cb21-802" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Shift in Standardized Center of Biomass Depth"</span>,</span>
<span id="cb21-803"><a href="#cb21-803" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Distributions weighted by biomass, weighted means shown as points."</span>,</span>
<span id="cb21-804"><a href="#cb21-804" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Center of Biomass Depth (z)"</span>,  </span>
<span id="cb21-805"><a href="#cb21-805" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">""</span>, </span>
<span id="cb21-806"><a href="#cb21-806" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Time Period"</span>, </span>
<span id="cb21-807"><a href="#cb21-807" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Time Period"</span>) <span class="sc">+</span></span>
<span id="cb21-808"><a href="#cb21-808" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb21-809"><a href="#cb21-809" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>, <span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb21-810"><a href="#cb21-810" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb21-811"><a href="#cb21-811" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-812"><a href="#cb21-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-813"><a href="#cb21-813" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb21-814"><a href="#cb21-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-815"><a href="#cb21-815" aria-hidden="true" tabindex="-1"></a>Across all species the average depth (by biomass) has increased from <span class="in">`r avg_depths[avg_depths$temp_regime == "Early Regime", 2][[1]]`</span> to <span class="in">`r avg_depths[avg_depths$temp_regime == "Warm Regime", 2][[1]]`</span> for a change in <span class="in">`r diff(avg_depths$biom_avg)`</span> meters.</span>
<span id="cb21-816"><a href="#cb21-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-817"><a href="#cb21-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-818"><a href="#cb21-818" aria-hidden="true" tabindex="-1"></a><span class="fu">## Center of Biomass</span></span>
<span id="cb21-819"><a href="#cb21-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-820"><a href="#cb21-820" aria-hidden="true" tabindex="-1"></a>Using both Lat/Lon we can determine a center of biomass, and how that has changed between regimes for each species.</span>
<span id="cb21-821"><a href="#cb21-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-824"><a href="#cb21-824" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-825"><a href="#cb21-825" aria-hidden="true" tabindex="-1"></a><span class="co"># Weighted mean Locations</span></span>
<span id="cb21-826"><a href="#cb21-826" aria-hidden="true" tabindex="-1"></a>center_coord_df <span class="ot">&lt;-</span> station_totals <span class="sc">%&gt;%</span> </span>
<span id="cb21-827"><a href="#cb21-827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(comname, temp_regime) <span class="sc">%&gt;%</span> </span>
<span id="cb21-828"><a href="#cb21-828" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb21-829"><a href="#cb21-829" aria-hidden="true" tabindex="-1"></a>    <span class="at">biom_lat  =</span> <span class="fu">weightedMean</span>(decdeg_beglat, biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-830"><a href="#cb21-830" aria-hidden="true" tabindex="-1"></a>    <span class="at">biom_lon  =</span> <span class="fu">weightedMean</span>(decdeg_beglon, biomass_kg, <span class="at">na.rm =</span> T),</span>
<span id="cb21-831"><a href="#cb21-831" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span>) </span>
<span id="cb21-832"><a href="#cb21-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-833"><a href="#cb21-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-834"><a href="#cb21-834" aria-hidden="true" tabindex="-1"></a><span class="co"># Coord ranges to crop</span></span>
<span id="cb21-835"><a href="#cb21-835" aria-hidden="true" tabindex="-1"></a>xlim <span class="ot">&lt;-</span> <span class="fu">range</span>(center_coord_df<span class="sc">$</span>biom_lon)</span>
<span id="cb21-836"><a href="#cb21-836" aria-hidden="true" tabindex="-1"></a>ylim <span class="ot">&lt;-</span> <span class="fu">range</span>(center_coord_df<span class="sc">$</span>biom_lat)</span>
<span id="cb21-837"><a href="#cb21-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-838"><a href="#cb21-838" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-839"><a href="#cb21-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-840"><a href="#cb21-840" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb21-841"><a href="#cb21-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-842"><a href="#cb21-842" aria-hidden="true" tabindex="-1"></a><span class="fu">#### COB Shifts</span></span>
<span id="cb21-843"><a href="#cb21-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-846"><a href="#cb21-846" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-847"><a href="#cb21-847" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.height = 7,</span></span>
<span id="cb21-848"><a href="#cb21-848" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.width = 7</span></span>
<span id="cb21-849"><a href="#cb21-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-850"><a href="#cb21-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-851"><a href="#cb21-851" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the map</span></span>
<span id="cb21-852"><a href="#cb21-852" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb21-853"><a href="#cb21-853" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> us_poly) <span class="sc">+</span></span>
<span id="cb21-854"><a href="#cb21-854" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> canada) <span class="sc">+</span></span>
<span id="cb21-855"><a href="#cb21-855" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">geom_link2</span>(</span>
<span id="cb21-856"><a href="#cb21-856" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> center_coord_df,</span>
<span id="cb21-857"><a href="#cb21-857" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> biom_lon, </span>
<span id="cb21-858"><a href="#cb21-858" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> biom_lat, </span>
<span id="cb21-859"><a href="#cb21-859" aria-hidden="true" tabindex="-1"></a>        <span class="at">group =</span> comname,</span>
<span id="cb21-860"><a href="#cb21-860" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha =</span> <span class="fu">stat</span>(index),</span>
<span id="cb21-861"><a href="#cb21-861" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"Warm Regime"</span>),</span>
<span id="cb21-862"><a href="#cb21-862" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">0.75</span>,</span>
<span id="cb21-863"><a href="#cb21-863" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb21-864"><a href="#cb21-864" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> center_coord_df, <span class="fu">aes</span>(<span class="at">x =</span> biom_lon, <span class="at">y =</span> biom_lat, <span class="at">color =</span> temp_regime), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb21-865"><a href="#cb21-865" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">data =</span> <span class="fu">filter</span>(center_coord_df, temp_regime <span class="sc">==</span> <span class="st">"Warm Regime"</span>), </span>
<span id="cb21-866"><a href="#cb21-866" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> comname, <span class="at">x =</span> biom_lon, <span class="at">y =</span> biom_lat), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb21-867"><a href="#cb21-867" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gmri</span>() <span class="sc">+</span></span>
<span id="cb21-868"><a href="#cb21-868" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim =</span> xlim, <span class="at">ylim =</span> ylim) <span class="sc">+</span></span>
<span id="cb21-869"><a href="#cb21-869" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb21-870"><a href="#cb21-870" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Temperature Regime"</span>, <span class="at">title =</span> <span class="st">"Weighted-Mean Center of Biomass"</span>)</span>
<span id="cb21-871"><a href="#cb21-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-872"><a href="#cb21-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-873"><a href="#cb21-873" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-874"><a href="#cb21-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-875"><a href="#cb21-875" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb21-876"><a href="#cb21-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-877"><a href="#cb21-877" aria-hidden="true" tabindex="-1"></a><span class="fu">## Move vs. Acclimate</span></span>
<span id="cb21-878"><a href="#cb21-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-879"><a href="#cb21-879" aria-hidden="true" tabindex="-1"></a>Species can achieve similar outcomes through either moving deeper, or more Northward, or some combination of both.</span>
<span id="cb21-880"><a href="#cb21-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-881"><a href="#cb21-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-884"><a href="#cb21-884" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-885"><a href="#cb21-885" aria-hidden="true" tabindex="-1"></a><span class="co"># Put metrics of species movements into one list/table:</span></span>
<span id="cb21-886"><a href="#cb21-886" aria-hidden="true" tabindex="-1"></a>change_datasets <span class="ot">&lt;-</span> <span class="fu">list</span>(lat_change, depth_change, temp_change)</span>
<span id="cb21-887"><a href="#cb21-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-888"><a href="#cb21-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-889"><a href="#cb21-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-890"><a href="#cb21-890" aria-hidden="true" tabindex="-1"></a><span class="co"># Pick mean/median and whether we want biomass or Biomass weighting:</span></span>
<span id="cb21-891"><a href="#cb21-891" aria-hidden="true" tabindex="-1"></a>change_datasets <span class="ot">&lt;-</span> <span class="fu">map</span>(change_datasets, <span class="cf">function</span>(x){</span>
<span id="cb21-892"><a href="#cb21-892" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-893"><a href="#cb21-893" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Grab the variable</span></span>
<span id="cb21-894"><a href="#cb21-894" aria-hidden="true" tabindex="-1"></a>  var_name <span class="ot">&lt;-</span> <span class="fu">distinct</span>(x, var) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()</span>
<span id="cb21-895"><a href="#cb21-895" aria-hidden="true" tabindex="-1"></a>  z_name <span class="ot">&lt;-</span> <span class="fu">str_c</span>(var_name, <span class="st">"_z"</span>)</span>
<span id="cb21-896"><a href="#cb21-896" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-897"><a href="#cb21-897" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Grab just those columns to compare across regimes:</span></span>
<span id="cb21-898"><a href="#cb21-898" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pivot wider, and find difference</span></span>
<span id="cb21-899"><a href="#cb21-899" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-900"><a href="#cb21-900" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Change in Standardized Means</span></span>
<span id="cb21-901"><a href="#cb21-901" aria-hidden="true" tabindex="-1"></a>  mu_dat <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">select</span>(comname, temp_regime, biom_z) <span class="sc">%&gt;%</span> </span>
<span id="cb21-902"><a href="#cb21-902" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">values_from =</span> biom_z, <span class="at">names_from =</span> temp_regime) <span class="sc">%&gt;%</span> </span>
<span id="cb21-903"><a href="#cb21-903" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">mu_change =</span> <span class="st">`</span><span class="at">Warm Regime</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">Early Regime</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-904"><a href="#cb21-904" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">"Early Regime"</span>, <span class="st">"Warm Regime"</span>))</span>
<span id="cb21-905"><a href="#cb21-905" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-906"><a href="#cb21-906" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb21-907"><a href="#cb21-907" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-908"><a href="#cb21-908" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb21-909"><a href="#cb21-909" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">setNames</span>(mu_dat, <span class="fu">c</span>(<span class="st">"comname"</span>, z_name)))</span>
<span id="cb21-910"><a href="#cb21-910" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-911"><a href="#cb21-911" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Rejoin</span></span>
<span id="cb21-912"><a href="#cb21-912" aria-hidden="true" tabindex="-1"></a>  <span class="co">#left_join(med_dat, mu_dat) %&gt;% setNames(c("comname", med_name, mu_name))</span></span>
<span id="cb21-913"><a href="#cb21-913" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-914"><a href="#cb21-914" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-915"><a href="#cb21-915" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb21-916"><a href="#cb21-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-917"><a href="#cb21-917" aria-hidden="true" tabindex="-1"></a><span class="co"># Join them</span></span>
<span id="cb21-918"><a href="#cb21-918" aria-hidden="true" tabindex="-1"></a>change_df <span class="ot">&lt;-</span> <span class="fu">left_join</span>(change_datasets[[<span class="dv">1</span>]], change_datasets[[<span class="dv">2</span>]]) <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(change_datasets[[<span class="dv">3</span>]])</span>
<span id="cb21-919"><a href="#cb21-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-920"><a href="#cb21-920" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare those features to the change in growth</span></span>
<span id="cb21-921"><a href="#cb21-921" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-922"><a href="#cb21-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-923"><a href="#cb21-923" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb21-924"><a href="#cb21-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-925"><a href="#cb21-925" aria-hidden="true" tabindex="-1"></a><span class="fu">### Depth and Latitude</span></span>
<span id="cb21-926"><a href="#cb21-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-929"><a href="#cb21-929" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-930"><a href="#cb21-930" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(change_df, <span class="fu">aes</span>(avgdepth_z, decdeg_beglat_z)) <span class="sc">+</span></span>
<span id="cb21-931"><a href="#cb21-931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y<span class="sc">~</span>x, <span class="at">color =</span> <span class="fu">gmri_cols</span>(<span class="st">"gmri blue"</span>)) <span class="sc">+</span></span>
<span id="cb21-932"><a href="#cb21-932" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb21-933"><a href="#cb21-933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Delta<span class="sc">~</span><span class="st">"Depth (z)"</span>),</span>
<span id="cb21-934"><a href="#cb21-934" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(Delta<span class="sc">~</span><span class="st">"Lat"</span><span class="sc">~</span>degree<span class="sc">~</span>N<span class="sc">~</span><span class="er">~</span><span class="st">"(z)"</span>))</span>
<span id="cb21-935"><a href="#cb21-935" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-936"><a href="#cb21-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-937"><a href="#cb21-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-938"><a href="#cb21-938" aria-hidden="true" tabindex="-1"></a><span class="fu">### Temperature and Latitude</span></span>
<span id="cb21-939"><a href="#cb21-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-942"><a href="#cb21-942" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-943"><a href="#cb21-943" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(change_df, <span class="fu">aes</span>(bottemp_z, decdeg_beglat_z)) <span class="sc">+</span></span>
<span id="cb21-944"><a href="#cb21-944" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb21-945"><a href="#cb21-945" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y<span class="sc">~</span>x, <span class="at">color =</span> <span class="fu">gmri_cols</span>(<span class="st">"gmri blue"</span>)) <span class="sc">+</span></span>
<span id="cb21-946"><a href="#cb21-946" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Delta<span class="sc">~</span><span class="st">"Bottom Temperature (z)"</span>),</span>
<span id="cb21-947"><a href="#cb21-947" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(Delta<span class="sc">~</span><span class="st">"Lat"</span><span class="sc">~</span>degree<span class="sc">~</span>N<span class="sc">~</span><span class="er">~</span><span class="st">"(z)"</span>))</span>
<span id="cb21-948"><a href="#cb21-948" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-949"><a href="#cb21-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-950"><a href="#cb21-950" aria-hidden="true" tabindex="-1"></a><span class="fu">### Temperature and Depth</span></span>
<span id="cb21-951"><a href="#cb21-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-954"><a href="#cb21-954" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb21-955"><a href="#cb21-955" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(change_df, <span class="fu">aes</span>(bottemp_z, avgdepth_z)) <span class="sc">+</span></span>
<span id="cb21-956"><a href="#cb21-956" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">formula =</span> y<span class="sc">~</span>x, <span class="at">color =</span> <span class="fu">gmri_cols</span>(<span class="st">"gmri blue"</span>)) <span class="sc">+</span></span>
<span id="cb21-957"><a href="#cb21-957" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb21-958"><a href="#cb21-958" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Delta<span class="sc">~</span><span class="st">"Bottom Temperature (z)"</span>),</span>
<span id="cb21-959"><a href="#cb21-959" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(Delta<span class="sc">~</span><span class="st">"Depth (z)"</span>))</span>
<span id="cb21-960"><a href="#cb21-960" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb21-961"><a href="#cb21-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-962"><a href="#cb21-962" aria-hidden="true" tabindex="-1"></a>:::</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>